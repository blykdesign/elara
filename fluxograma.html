<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fluxograma Elara - Outlet Premium SP</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { overflow: hidden; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useCallback, useMemo } = React;



// â”€â”€â”€ Color Palette â”€â”€â”€
const COLORS = {
  user: "#25D366",
  elara: "#075E54",
  elaraBg: "#DCF8C6",
  decision: "#F59E0B",
  decisionBg: "#FEF3C7",
  system: "#6366F1",
  systemBg: "#EEF2FF",
  danger: "#EF4444",
  dangerBg: "#FEE2E2",
  success: "#10B981",
  successBg: "#D1FAE5",
  info: "#3B82F6",
  infoBg: "#DBEAFE",
  tracking: "#8B5CF6",
  trackingBg: "#EDE9FE",
  bg: "#ECE5DD",
  cardBg: "#FFFFFF",
  border: "#E5E7EB",
  textPrimary: "#111827",
  textSecondary: "#6B7280",
};

// â”€â”€â”€ All Flows Data â”€â”€â”€
const FLOWS = [
  {
    id: "terms",
    title: "Aceite de Termos",
    section: "Â§11.1",
    icon: "ğŸ“‹",
    description: "Aceite obrigatÃ³rio dos Termos de Uso e Privacidade antes de qualquer interaÃ§Ã£o",
    nodes: [
      { id: "t1", type: "user", label: "UsuÃ¡rio inicia\nconversa", x: 50, y: 0 },
      { id: "t2", type: "decision", label: "JÃ¡ aceitou\ntermos\nanteriormente?", x: 50, y: 14 },
      { id: "t3", type: "success", label: "Pular para\nPrimeiro Contato\nâ†’ Fluxo: Primeiro Contato", x: 85, y: 14 },
      { id: "t4", type: "elara", label: "Exibir resumo dos\nTermos + link da\nPolÃ­tica de Privacidade\n[ Aceito ] [ NÃ£o Aceito ]", x: 50, y: 30 },
      { id: "t5", type: "decision", label: "UsuÃ¡rio\nclicou em?", x: 50, y: 46 },
      { id: "t6", type: "success", label: "[ Aceito ]\nRegistrar no perfil\nâ†’ Fluxo: Primeiro Contato", x: 15, y: 60 },
      { id: "t7", type: "elara", label: "[ NÃ£o Aceito ]\nExplicar necessidade\n+ link da polÃ­tica\n+ reapresentar botÃµes\n[ Aceito ] [ NÃ£o Aceito ]", x: 60, y: 60 },
      { id: "t8", type: "decision", label: "2a tentativa:\nusuÃ¡rio\nclicou em?", x: 60, y: 78 },
      { id: "t9", type: "success", label: "[ Aceito ]\nRegistrar no perfil\nâ†’ Fluxo: Primeiro Contato", x: 25, y: 78 },
      { id: "t10", type: "danger", label: "[ NÃ£o Aceito ]\nEncerrar conversa:\n\"Tudo bem! Se mudar\nde ideia, Ã© sÃ³ me\nchamar de novo.\"", x: 85, y: 78 },
      { id: "t11", type: "system", label: "Regras:\nâ€¢ Aceite persiste entre sessÃµes\nâ€¢ MÃ¡x 2 reapresentaÃ§Ãµes\nâ€¢ Nunca iniciar fluxo\n  funcional sem aceite\nâ€¢ Formato: Quick Reply\n  (sem digitar texto)", x: 50, y: 100 },
    ],
    edges: [
      { from: "t1", to: "t2" },
      { from: "t2", to: "t3", label: "SIM" },
      { from: "t2", to: "t4", label: "NÃƒO" },
      { from: "t4", to: "t5" },
      { from: "t5", to: "t6", label: "Aceito" },
      { from: "t5", to: "t7", label: "NÃ£o Aceito" },
      { from: "t7", to: "t8" },
      { from: "t8", to: "t9", label: "Aceito" },
      { from: "t8", to: "t10", label: "NÃ£o Aceito\n(2a recusa)" },
    ],
    conversation: [
      { from: "system", text: "ğŸ“‹ CenÃ¡rio 1: Aceita na primeira vez" },
      { from: "elara", text: "OlÃ¡! Antes de comeÃ§ar, preciso que vocÃª aceite nossos Termos de Uso e PolÃ­tica de Privacidade.\n\nResumo: seus dados serÃ£o usados apenas para personalizar sua experiÃªncia no Outlet Premium SÃ£o Paulo.\n\nPolÃ­tica completa: [link]\n\n[ Aceito ] [ NÃ£o Aceito ]" },
      { from: "user", text: "[ Aceito ]" },
      { from: "system", text: "âœ… Aceite registrado no perfil\nâ†’ Segue para: Fluxo Primeiro Contato" },
      { from: "elara", text: "Que bom que vocÃª estÃ¡ no Outlet! ğŸ¬\nO que te traz aqui hoje?\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“‹ CenÃ¡rio 2: Recusa, depois aceita" },
      { from: "elara", text: "OlÃ¡! Antes de comeÃ§ar, preciso que vocÃª aceite nossos Termos de Uso e PolÃ­tica de Privacidade.\n\nResumo: seus dados serÃ£o usados apenas para personalizar sua experiÃªncia.\n\n[ Aceito ] [ NÃ£o Aceito ]" },
      { from: "user", text: "[ NÃ£o Aceito ]" },
      { from: "elara", text: "Para que eu possa te ajudar com nossas lojas, promoÃ§Ãµes e serviÃ§os, Ã© importante que vocÃª concorde com a nossa PolÃ­tica de Privacidade.\n\nVocÃª pode ler a polÃ­tica completa aqui: [link]\n\n[ Aceito ] [ NÃ£o Aceito ]" },
      { from: "user", text: "[ Aceito ]" },
      { from: "system", text: "âœ… Aceite registrado\nâ†’ Segue para: Fluxo Primeiro Contato" },
      { from: "elara", text: "Que bom que vocÃª estÃ¡ no Outlet! ğŸ¬\nO que te traz aqui hoje?\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“‹ CenÃ¡rio 3: Dupla recusa - encerrar" },
      { from: "elara", text: "OlÃ¡! Antes de comeÃ§ar, preciso que vocÃª aceite nossos Termos de Uso.\n\n[ Aceito ] [ NÃ£o Aceito ]" },
      { from: "user", text: "[ NÃ£o Aceito ]" },
      { from: "elara", text: "Para que eu possa te ajudar, Ã© importante que vocÃª concorde com a nossa PolÃ­tica de Privacidade.\n\n[ Aceito ] [ NÃ£o Aceito ]" },
      { from: "user", text: "[ NÃ£o Aceito ]" },
      { from: "elara", text: "Tudo bem! Se mudar de ideia, Ã© sÃ³ me chamar de novo. ğŸ˜Š" },
      { from: "system", text: "âŒ Conversa encerrada (2a recusa)" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“‹ CenÃ¡rio 4: UsuÃ¡rio retorna (jÃ¡ aceitou)" },
      { from: "system", text: "âœ“ Aceite jÃ¡ registrado - pular termos\nâ†’ Direto para: Fluxo Primeiro Contato" },
      { from: "elara", text: "Oi de novo! Em que posso te ajudar?\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
    ],
  },
  {
    id: "entry",
    title: "Primeiro Contato",
    section: "Â§10.1, Â§12.3",
    icon: "ğŸ‘‹",
    description: "Fluxo de entrada do usuÃ¡rio na conversa",
    nodes: [
      { id: "e1", type: "system", label: "UsuÃ¡rio aceita\nTermos de Uso\n(vem do Fluxo:\nAceite de Termos)", x: 50, y: 0 },
      { id: "e2", type: "decision", label: "Primeira interaÃ§Ã£o\nou retorno > 24h?", x: 50, y: 15 },
      { id: "e3", type: "elara", label: "Greeting completo:\n\"OlÃ¡, meu nome Ã© Elara,\na assistente do Outlet\nPremium SÃ£o Paulo\"", x: 20, y: 30 },
      { id: "e4", type: "elara", label: "Greeting curto:\n\"Oi de novo! Em que\nposso te ajudar?\"", x: 80, y: 30 },
      { id: "e5", type: "elara", label: "Fluxo guiado com botÃµes:\n\"O que te traz aqui hoje?\"\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]", x: 50, y: 48 },
      { id: "e6", type: "decision", label: "UsuÃ¡rio tem\nperfil salvo?", x: 50, y: 63 },
      { id: "e7", type: "elara", label: "Personalizar com perfil:\n\"A Nike e a Adidas tÃªm\nnovidades desde sua\nÃºltima visita ğŸ‘Ÿ\"", x: 20, y: 78 },
      { id: "e8", type: "system", label: "â†’ Seguir para\nFluxo: Hierarquia\nde Objetivos", x: 50, y: 93 },
    ],
    edges: [
      { from: "e1", to: "e2" },
      { from: "e2", to: "e3", label: "SIM" },
      { from: "e2", to: "e4", label: "NÃƒO" },
      { from: "e3", to: "e5" },
      { from: "e4", to: "e5" },
      { from: "e5", to: "e6" },
      { from: "e6", to: "e7", label: "SIM" },
      { from: "e6", to: "e8", label: "NÃƒO" },
      { from: "e7", to: "e8" },
    ],
    conversation: [
      { from: "system", text: "ğŸ‘‹ CenÃ¡rio 1: Primeira visita" },
      { from: "system", text: "âœ“ Vem do: Fluxo Aceite de Termos" },
      { from: "elara", text: "OlÃ¡, meu nome Ã© Elara, a assistente pessoal do Outlet Premium SÃ£o Paulo! ğŸ˜Š" },
      { from: "elara", text: "Que bom que vocÃª estÃ¡ no Outlet! ğŸ¬\nO que te traz aqui hoje?\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
      { from: "user", text: "[ PromoÃ§Ãµes ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Hierarquia de Objetivos â†’ Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ‘‹ CenÃ¡rio 2: Retorno (< 24h)" },
      { from: "elara", text: "Oi de novo! Em que posso te ajudar? ğŸ˜Š\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
      { from: "user", text: "[ Lojas ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Hierarquia de Objetivos" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ‘‹ CenÃ¡rio 3: Com perfil salvo" },
      { from: "elara", text: "OlÃ¡, meu nome Ã© Elara! ğŸ˜Š\nO que te traz aqui hoje?\n\n[ PromoÃ§Ãµes ] [ Lojas ] [ AlimentaÃ§Ã£o ]" },
      { from: "user", text: "[ PromoÃ§Ãµes ]" },
      { from: "system", text: "ğŸ‘¤ Perfil salvo detectado â†’ personalizar" },
      { from: "elara", text: "A Nike e a Adidas tÃªm novidades desde sua Ãºltima visita ğŸ‘Ÿ\nQuer ver as promoÃ§Ãµes?\n\n[ Ver promoÃ§Ãµes ] [ Outra categoria ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Hierarquia de Objetivos" },
    ],
  },
  {
    id: "hierarchy",
    title: "Hierarquia de Objetivos",
    section: "Â§1.1",
    icon: "ğŸ¯",
    description: "Prioridades que guiam toda resposta da Elara",
    nodes: [
      { id: "h1", type: "system", label: "Mensagem do usuÃ¡rio\nrecebida", x: 50, y: 0 },
      { id: "h2", type: "decision", label: "Tema Ã©\nRESTRITO? (Â§18)", x: 50, y: 13 },
      { id: "h3", type: "danger", label: "Resposta padrÃ£o\n+ redirecionamento\nâ†’ Fluxo: RestriÃ§Ãµes\nde ConteÃºdo", x: 85, y: 13 },
      { id: "h4", type: "decision", label: "Tema Ã©\nSENSÃVEL?\n(saÃºde, seguranÃ§a...)", x: 50, y: 28 },
      { id: "h5", type: "elara", label: "Responder 100%\nfoco no problema\nSEM ponte comercial", x: 85, y: 28 },
      { id: "h6", type: "decision", label: "Qual tipo\nde intenÃ§Ã£o?", x: 50, y: 43 },
      { id: "h7", type: "success", label: "PRIORIDADE 1\nExibir anÃºncio/oferta\nrelevante\n(impressÃ£o comercial)", x: 15, y: 60 },
      { id: "h8", type: "info", label: "PRIORIDADE 2\nGerar intenÃ§Ã£o\nde visita Ã  loja\n(sem anÃºncio ativo)", x: 50, y: 60 },
      { id: "h9", type: "elara", label: "PRIORIDADE 3\nInformar com\nutilidade\n(responder pergunta)", x: 85, y: 60 },
      { id: "h10", type: "system", label: "Tentar ponte para\nPrioridade 1 ou 2\nâ†’ Fluxo: Ponte Comercial", x: 85, y: 78 },
      { id: "h11", type: "system", label: "â†’ Fluxo: Busca\ne Resultados", x: 15, y: 78 },
    ],
    edges: [
      { from: "h1", to: "h2" },
      { from: "h2", to: "h3", label: "SIM" },
      { from: "h2", to: "h4", label: "NÃƒO" },
      { from: "h4", to: "h5", label: "SIM" },
      { from: "h4", to: "h6", label: "NÃƒO" },
      { from: "h6", to: "h7", label: "Busca\nproduto/marca" },
      { from: "h6", to: "h8", label: "Sem\nanÃºncio ativo" },
      { from: "h6", to: "h9", label: "Pergunta\ninformacional" },
      { from: "h9", to: "h10" },
      { from: "h7", to: "h11" },
    ],
    conversation: [
      { from: "system", text: "ğŸ¯ CenÃ¡rio 1: Busca por produto (Prioridade 1)" },
      { from: "user", text: "Quero ver tÃªnis de corrida" },
      { from: "system", text: "ğŸ¯ IntenÃ§Ã£o: busca por produto â†’ PRIORIDADE 1 (exibir anÃºncio)\nâ†’ Segue para: Fluxo Busca e Resultados" },
      { from: "elara", text: "Separei os melhores anÃºncios de tÃªnis pra vocÃª ğŸƒ\n[Carrossel com 5 cards]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 2: Informacional (Prioridade 3)" },
      { from: "user", text: "Qual o horÃ¡rio do outlet?" },
      { from: "system", text: "ğŸ¯ IntenÃ§Ã£o: informacional â†’ PRIORIDADE 3 (informar)\nâ†’ Tentar: Fluxo Ponte Comercial" },
      { from: "elara", text: "*HorÃ¡rio hoje:*\nğŸ• 9h Ã s 21h\n\nPrecisa de mais alguma coisa? Posso te mostrar promoÃ§Ãµes ğŸ˜‰\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ] [ Era sÃ³ isso ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 3: Tema RESTRITO" },
      { from: "user", text: "O que vocÃª acha da polÃ­tica?" },
      { from: "system", text: "ğŸ¯ Tema RESTRITO detectado (Â§18)\nâ†’ Segue para: Fluxo RestriÃ§Ãµes de ConteÃºdo" },
      { from: "elara", text: "NÃ£o consigo te ajudar com isso, mas posso te mostrar as novidades do Outlet! â­\n\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 4: Tema SENSÃVEL" },
      { from: "user", text: "Perdi minha carteira, o que faÃ§o?" },
      { from: "system", text: "ğŸ¯ Tema SENSÃVEL detectado â†’ 100% foco no problema\nâŒ Sem ponte comercial" },
      { from: "elara", text: "Entendo sua preocupaÃ§Ã£o! Dirija-se Ã  administraÃ§Ã£o no *Bloco 01* para registrar a ocorrÃªncia. A equipe de seguranÃ§a pode te ajudar.\n\nPosso te passar o telefone da administraÃ§Ã£o?" },
    ],
  },
  {
    id: "search",
    title: "Busca e Resultados",
    section: "Â§5, Â§6, Â§10.1.1",
    icon: "ğŸ”",
    description: "Fluxo completo de busca por marca, categoria ou texto livre",
    nodes: [
      { id: "s1", type: "user", label: "UsuÃ¡rio faz\numa busca", x: 50, y: 0 },
      { id: "s2", type: "system", label: "Classificar intenÃ§Ã£o\n(Â§6.1): categoria,\ntipo, filtro", x: 50, y: 10 },
      { id: "s3", type: "system", label: "Aplicar Filtro\nSemÃ¢ntico (Â§6.2)\nHard Filter", x: 50, y: 20 },
      { id: "s4", type: "decision", label: "Quantos\nresultados\nvÃ¡lidos?", x: 50, y: 32 },
      { id: "s5", type: "danger", label: "ZERO resultados\nâ†’ Fluxo: Fallback\nde Resultados", x: 10, y: 44 },
      { id: "s6", type: "elara", label: "1 resultado\nIntro opcional (Â§5.2)\nExibir card direto", x: 35, y: 44 },
      { id: "s7", type: "elara", label: "2-5 resultados\nIntro + Carrossel\ndireto", x: 60, y: 44 },
      { id: "s8", type: "decision", label: "> 5 resultados\nRefinar?\nâ†’ Fluxo: PaginaÃ§Ã£o", x: 87, y: 44 },
      { id: "s9", type: "elara", label: "Pergunta de\nrefinamento\n(mÃ¡x 1 pergunta)", x: 87, y: 58 },
      { id: "s10", type: "decision", label: "Resultado\nrefinado â‰¤ 5?", x: 87, y: 70 },
      { id: "s11", type: "elara", label: "Exibir 5 mais\nrelevantes\n+ PaginaÃ§Ã£o", x: 87, y: 82 },
      { id: "s12", type: "system", label: "Tracking:\nad_impression\nâ†’ Fluxo: Tracking\nde Cards", x: 50, y: 60 },
      { id: "s13", type: "elara", label: "BotÃµes pÃ³s-anÃºncio:\n[ Quero visitar ]\n[ Como chegar ]", x: 50, y: 73 },
      { id: "s14", type: "system", label: "â†’ Fluxo: InserÃ§Ã£o\nProativa ou\nFluxo: PaginaÃ§Ã£o\ne Refinamento", x: 50, y: 86 },
    ],
    edges: [
      { from: "s1", to: "s2" },
      { from: "s2", to: "s3" },
      { from: "s3", to: "s4" },
      { from: "s4", to: "s5", label: "0" },
      { from: "s4", to: "s6", label: "1" },
      { from: "s4", to: "s7", label: "2-5" },
      { from: "s4", to: "s8", label: "> 5" },
      { from: "s8", to: "s9" },
      { from: "s9", to: "s10" },
      { from: "s10", to: "s7", label: "SIM" },
      { from: "s10", to: "s11", label: "NÃƒO" },
      { from: "s6", to: "s12" },
      { from: "s7", to: "s12" },
      { from: "s11", to: "s12" },
      { from: "s12", to: "s13" },
      { from: "s13", to: "s14" },
    ],
    conversation: [
      { from: "system", text: "ğŸ” CenÃ¡rio 1: Muitos resultados (> 5) â†’ refinar" },
      { from: "user", text: "Quero ver promoÃ§Ãµes de esportivo" },
      { from: "system", text: "ğŸ” ClassificaÃ§Ã£o: categoria=esportivo, tipo=promoÃ§Ãµes\nâœ“ Filtro semÃ¢ntico: aceitar tÃªnis, roupa esportiva / rejeitar Ã³culos, bolsas\nğŸ“Š Resultados: 12 anÃºncios vÃ¡lidos (> 5 â†’ refinar)" },
      { from: "elara", text: "Encontrei muitas promoÃ§Ãµes de esportivo! Para ficar mais fÃ¡cil, o que te interessa mais?\n\n[ TÃªnis ] [ Roupas ] [ AcessÃ³rios ] [ Ver destaques ]" },
      { from: "user", text: "[ TÃªnis ]" },
      { from: "system", text: "ğŸ“Š Resultado refinado: 4 anÃºncios (â‰¤ 5 â†’ exibir direto)" },
      { from: "elara", text: "Separei as melhores de tÃªnis pra vocÃª ğŸƒ\n[Carrossel com 4 cards]\n\n[ Quero visitar ] [ Como chegar ]" },
      { from: "system", text: "âœ“ ad_impression registrado (4 anÃºncios)\nâ†’ Ver: Fluxo Tracking de Cards" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ” CenÃ¡rio 2: Poucos resultados (2-5) â†’ direto" },
      { from: "user", text: "PromoÃ§Ãµes da Nike" },
      { from: "system", text: "ğŸ” ClassificaÃ§Ã£o: marca=Nike\nğŸ“Š Resultados: 3 anÃºncios â†’ exibir direto" },
      { from: "elara", text: "A *Nike* estÃ¡ com essas promoÃ§Ãµes ğŸ‘Ÿ\n[Carrossel com 3 cards]\n\n[ Quero visitar ] [ Como chegar ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ” CenÃ¡rio 3: Um resultado â†’ card direto" },
      { from: "user", text: "Tem promoÃ§Ã£o da Pandora?" },
      { from: "system", text: "ğŸ” ClassificaÃ§Ã£o: marca=Pandora\nğŸ“Š Resultados: 1 anÃºncio â†’ exibir direto" },
      { from: "elara", text: "A *Pandora* estÃ¡ com esta promoÃ§Ã£o especial ğŸ’\n[Card Ãºnico com detalhes]\n\n[ Quero visitar ] [ Como chegar ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ” CenÃ¡rio 4: Zero resultados â†’ fallback" },
      { from: "user", text: "PromoÃ§Ã£o de roupas de ski" },
      { from: "system", text: "ğŸ” ClassificaÃ§Ã£o: categoria=ski\nğŸ“Š Resultados: 0 â†’ Fluxo Fallback de Resultados" },
      { from: "elara", text: "NÃ£o encontrei promoÃ§Ãµes de ski, mas separei opÃ§Ãµes de *esportivo* que podem servir!\n[Carrossel com 3 cards]" },
    ],
  },
  {
    id: "fallback",
    title: "Fallback de Resultados",
    section: "Â§5.2.1, Â§15",
    icon: "ğŸ”„",
    description: "Quando a busca nÃ£o retorna resultados: marca, loja, categoria, informacional, busca livre",
    nodes: [
      // Topo
      { id: "f1", type: "danger", label: "Busca sem\nresultado direto", x: 50, y: 0 },
      { id: "f2", type: "decision", label: "Tipo de\nbusca?", x: 50, y: 12 },
      // Col 1: MARCA (center x=8)
      { id: "f3", type: "decision", label: "MARCA:\nTem loja prÃ³pria\nno outlet?", x: 8, y: 28 },
      { id: "f4", type: "elara", label: "SIM: Loja prÃ³pria\nInformar localizaÃ§Ã£o\n+ verificar promoÃ§Ãµes", x: 2, y: 44 },
      { id: "f5", type: "decision", label: "NÃƒO: Vendida em\nMULTIMARCAS?", x: 16, y: 44 },
      { id: "f6", type: "elara", label: "SIM: Multimarcas\n\"A *Sephora* trabalha\ncom essa marca\"\n[ Como chegar ]", x: 10, y: 62 },
      { id: "f7", type: "elara", label: "NÃƒO: IndisponÃ­vel\n\"Essa marca nÃ£o estÃ¡\nno Outlet\"\n[ Ver marcas similares ]", x: 22, y: 62 },
      { id: "f16", type: "decision", label: "PromoÃ§Ãµes no\nMESMO SEGMENTO?", x: 10, y: 80 },
      { id: "f17", type: "elara", label: "SIM: Alternativas\nsegmento (mÃ¡x 3 cards)\n- Fluxo: Busca\ne Resultados", x: 4, y: 96 },
      // Col 2: LOJA (center x=32)
      { id: "f18", type: "decision", label: "LOJA:\nLoja existe\nno outlet?", x: 32, y: 28 },
      { id: "f19", type: "elara", label: "SIM: LocalizaÃ§Ã£o\n+ promoÃ§Ãµes ativas\n- Fluxo: ApresentaÃ§Ã£o\nde Lojas", x: 26, y: 44 },
      { id: "f20", type: "elara", label: "NÃƒO: Sugerir lojas\ndo mesmo segmento\n[ Ver lojas do segmento ]\n[ Buscar outra loja ]", x: 38, y: 44 },
      // Col 3: CATEGORIA (center x=54)
      { id: "f8", type: "decision", label: "CATEGORIA:\nHÃ¡ categorias\nadjacentes?", x: 54, y: 28 },
      { id: "f9", type: "elara", label: "SIM: PromoÃ§Ãµes de\ncategorias adjacentes\n(3 cards)\n- Fluxo: Busca\ne Resultados", x: 48, y: 44 },
      { id: "f10", type: "elara", label: "NÃƒO: NavegaÃ§Ã£o\n[ Ver categorias ]\n[ Buscar outra coisa ]\n- Fluxo: ContextualizaÃ§Ã£o", x: 60, y: 44 },
      // Col 4: INFORMACIONAL (center x=74)
      { id: "f21", type: "decision", label: "INFORMACIONAL:\nInfo existe\nna base?", x: 74, y: 28 },
      { id: "f22", type: "elara", label: "SIM: Responder\ncom info disponÃ­vel\n- Fluxo: Ponte\nComercial", x: 68, y: 44 },
      { id: "f23", type: "elara", label: "NÃƒO: \"NÃ£o tenho\nessa informaÃ§Ã£o\"\n[ Lojas ] [ PromoÃ§Ãµes ]", x: 80, y: 44 },
      // Col 5: LIVRE (center x=94)
      { id: "f11", type: "decision", label: "LIVRE:\nPossÃ­vel inferir\nsegmento?", x: 94, y: 28 },
      { id: "f12", type: "system", label: "SIM: Tratar como\ncategoria inferida\n- Fluxo: Busca\ne Resultados", x: 88, y: 44 },
      { id: "f13", type: "elara", label: "NÃƒO: Fluxo guiado\n\"Para qual ocasiÃ£o?\"\n+ botÃµes\n- Fluxo: ContextualizaÃ§Ã£o", x: 100, y: 44 },
      // Fundo: ZERO anÃºncios
      { id: "f14", type: "system", label: "ZERO anÃºncios\nno outlet inteiro", x: 54, y: 82 },
      { id: "f15", type: "elara", label: "\"NÃ£o tenho promoÃ§Ãµes\nagora, mas posso ajudar\"\n[ Ver lojas ] [ HorÃ¡rio ] [ Mapa ]\n- Fluxo: ApresentaÃ§Ã£o de Lojas", x: 54, y: 98 },
    ],
    edges: [
      { from: "f1", to: "f2" },
      { from: "f2", to: "f3", label: "Marca" },
      { from: "f2", to: "f18", label: "Loja" },
      { from: "f2", to: "f8", label: "Categoria" },
      { from: "f2", to: "f21", label: "Informacional" },
      { from: "f2", to: "f11", label: "Livre" },
      // Marca (bifurcado)
      { from: "f3", to: "f4", label: "SIM" },
      { from: "f3", to: "f5", label: "NÃƒO" },
      { from: "f5", to: "f6", label: "SIM" },
      { from: "f5", to: "f7", label: "NÃƒO" },
      { from: "f4", to: "f16" },
      { from: "f6", to: "f16" },
      { from: "f7", to: "f16" },
      { from: "f16", to: "f17", label: "SIM" },
      { from: "f16", to: "f14", label: "NÃƒO" },
      // Loja (bifurcado)
      { from: "f18", to: "f19", label: "SIM" },
      { from: "f18", to: "f20", label: "NÃƒO" },
      // Categoria (bifurcado)
      { from: "f8", to: "f9", label: "SIM" },
      { from: "f8", to: "f10", label: "NÃƒO" },
      // Informacional (bifurcado)
      { from: "f21", to: "f22", label: "SIM" },
      { from: "f21", to: "f23", label: "NÃƒO" },
      // Livre (bifurcado)
      { from: "f11", to: "f12", label: "SIM" },
      { from: "f11", to: "f13", label: "NÃƒO" },
      // NÃƒO paths convergem para Zero
      { from: "f10", to: "f14" },
      { from: "f20", to: "f14" },
      { from: "f23", to: "f14" },
      { from: "f14", to: "f15" },
    ],
    conversation: [
      { from: "user", text: "Tem promoÃ§Ã£o da Chanel?" },
      { from: "system", text: "ğŸ”„ Tipo: MARCA\nâŒ Chanel sem loja prÃ³pria no outlet\nğŸ” Vendida em multimarcas? SIM - Sephora" },
      { from: "elara", text: "NÃ£o achei ofertas da *Chanel* agora, mas a *Sephora* (Bloco 03, Loja 71) trabalha com essa marca ğŸ”\n\n[ Como chegar na Sephora ] [ Outra marca ] [ Ver perfumaria ]" },
      { from: "system", text: "â†’ [ Como chegar ] â†’ Fluxo: ApresentaÃ§Ã£o de Lojas\nâ†’ [ Ver perfumaria ] â†’ Fluxo: Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Quero ver relÃ³gios Rolex" },
      { from: "system", text: "ğŸ”„ Tipo: MARCA\nâŒ Rolex sem loja prÃ³pria\nâŒ NÃ£o vendida em multimarcas\nğŸ” PromoÃ§Ãµes no segmento relojoaria? SIM" },
      { from: "elara", text: "A *Rolex* nÃ£o estÃ¡ no Outlet Premium, mas separei promoÃ§Ãµes de relojoaria pra vocÃª!\n[Carrossel com 3 cards: Fossil, Technos, Vivara]\n\n[ Quero visitar ] [ Buscar outra marca ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Onde fica a Nike?" },
      { from: "system", text: "ğŸ”„ Tipo: LOJA\nâœ“ Nike existe no outlet â†’ localizaÃ§Ã£o + promoÃ§Ãµes" },
      { from: "elara", text: "A *Nike* fica no *Bloco 04, Loja 130* ğŸ“\nE estÃ¡ com promoÃ§Ãµes ativas! Quer ver?\n\n[ Ver promoÃ§Ãµes ] [ Como chegar ]" },
      { from: "system", text: "â†’ Segue para: Fluxo ApresentaÃ§Ã£o de Lojas" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Onde fica a loja da Gucci?" },
      { from: "system", text: "ğŸ”„ Tipo: LOJA\nâŒ Gucci nÃ£o existe no outlet\nğŸ” Sugerindo lojas do mesmo segmento (luxo)" },
      { from: "elara", text: "NÃ£o encontrei a *Gucci* no Outlet Premium. Mas tem lojas de moda luxo que podem te interessar!\n\n[ Ver lojas de luxo ] [ Buscar outra loja ]" },
      { from: "system", text: "â†’ [ Ver lojas de luxo ] â†’ Fluxo: ApresentaÃ§Ã£o de Lojas" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Tem promoÃ§Ã£o de roupa de yoga?" },
      { from: "system", text: "ğŸ”„ Tipo: CATEGORIA\nâŒ Sem resultado direto para 'yoga'\nğŸ” Categorias adjacentes? SIM â†’ esportivo, fitness" },
      { from: "elara", text: "NÃ£o encontrei promoÃ§Ãµes especÃ­ficas de yoga, mas separei opÃ§Ãµes de *esportivo e fitness* que podem servir!\n[Carrossel com 3 cards]\n\n[ Quero visitar ] [ Buscar outra categoria ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Qual o wifi do outlet?" },
      { from: "system", text: "ğŸ”„ Tipo: INFORMACIONAL\nâŒ Info nÃ£o disponÃ­vel na base" },
      { from: "elara", text: "NÃ£o tenho essa informaÃ§Ã£o, mas posso te ajudar com outras coisas!\n\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ] [ HorÃ¡rio ]" },
      { from: "system", text: "â†’ [ Ver promoÃ§Ãµes ] â†’ Fluxo: Busca e Resultados\nâ†’ [ Encontrar loja ] â†’ Fluxo: ApresentaÃ§Ã£o de Lojas" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Quero algo legal" },
      { from: "system", text: "ğŸ”„ Tipo: LIVRE\nâŒ NÃ£o Ã© possÃ­vel inferir segmento\nâ†’ Fluxo guiado" },
      { from: "elara", text: "Para qual ocasiÃ£o seria?\n\n[ Presente ] [ Dia a dia ] [ Esporte ] [ Trabalho ]" },
      { from: "system", text: "â†’ Segue para: Fluxo ContextualizaÃ§Ã£o" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 8: MARCA - SIM loja prÃ³pria" },
      { from: "user", text: "Tem promoÃ§Ã£o da Nike?" },
      { from: "system", text: "ğŸ”„ Tipo: MARCA\nâœ“ Nike tem loja prÃ³pria no outlet â†’ localizaÃ§Ã£o + promoÃ§Ãµes" },
      { from: "elara", text: "A *Nike* tem loja prÃ³pria no Outlet! Fica no *Bloco 04, Loja 130* ğŸ“\nE estÃ¡ com promoÃ§Ãµes ativas:\n[Carrossel com 3 cards]\n\n[ Quero visitar ] [ Como chegar ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 9: CATEGORIA - NÃƒO tem adjacentes" },
      { from: "user", text: "Tem promoÃ§Ã£o de instrumentos musicais?" },
      { from: "system", text: "ğŸ”„ Tipo: CATEGORIA\nâŒ Sem resultado para 'instrumentos musicais'\nâŒ Sem categorias adjacentes\nâ†’ NavegaÃ§Ã£o guiada" },
      { from: "elara", text: "NÃ£o encontrei promoÃ§Ãµes de instrumentos musicais. Quer explorar outras categorias?\n\n[ Ver categorias ] [ Buscar outra coisa ]" },
      { from: "system", text: "â†’ Segue para: Fluxo ContextualizaÃ§Ã£o" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 10: INFORMACIONAL - SIM existe na base" },
      { from: "user", text: "Qual o horÃ¡rio do outlet amanhÃ£?" },
      { from: "system", text: "ğŸ”„ Tipo: INFORMACIONAL\nâœ“ Info disponÃ­vel na base" },
      { from: "elara", text: "*HorÃ¡rio de amanhÃ£:*\nğŸ• 9h Ã s 21h\n\nPrecisa de mais alguma coisa? Posso te mostrar promoÃ§Ãµes ğŸ˜‰\n\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ] [ Era sÃ³ isso ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Ponte Comercial" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 11: LIVRE - SIM consegue inferir segmento" },
      { from: "user", text: "Quero algo pra correr" },
      { from: "system", text: "ğŸ”„ Tipo: LIVRE\nâœ“ InferÃªncia: 'correr' â†’ segmento esportivo\nâ†’ Tratar como categoria" },
      { from: "elara", text: "Separei promoÃ§Ãµes de *esportivo* que sÃ£o Ã³timas pra corrida ğŸƒ\n[Carrossel com 4 cards]\n\n[ Quero visitar ] [ Como chegar ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
    ],
  },
  {
    id: "pagination",
    title: "PaginaÃ§Ã£o e Refinamento",
    section: "Â§10.1.1",
    icon: "ğŸ“„",
    description: "Regras de \"ver mais\" com limite de 3 pÃ¡ginas (15 resultados)",
    nodes: [
      { id: "p1", type: "system", label: "Resultado > 5 itens\napÃ³s refinamento", x: 50, y: 0 },
      { id: "p2", type: "elara", label: "PÃGINA 1\nExibir 5 mais\nrelevantes\n+ \"Quer ver mais?\"", x: 50, y: 14 },
      { id: "p3", type: "decision", label: "UsuÃ¡rio clica\n\"Quer ver mais\"?", x: 50, y: 30 },
      { id: "p4", type: "elara", label: "PÃGINA 2\nExibir prÃ³ximos 5\n+ \"Quer ver mais?\"", x: 30, y: 44 },
      { id: "p5", type: "system", label: "â†’ Fluxo: ContextualizaÃ§Ã£o\n(outra categoria)\nou Fluxo: Coleta\nde NPS (era sÃ³ isso)", x: 75, y: 44 },
      { id: "p6", type: "decision", label: "UsuÃ¡rio clica\n\"Quer ver mais\"\nnovamente?", x: 30, y: 58 },
      { id: "p7", type: "elara", label: "PÃGINA 3 (ÃšLTIMA)\nExibir prÃ³ximos 5\n\"Esses sÃ£o todos!\"", x: 15, y: 73 },
      { id: "p8", type: "elara", label: "Encerrar paginaÃ§Ã£o:\n\"Quer refinar a busca\nou ver outra categoria?\"\n[ Refinar ] [ Outra ] [ Pronto ]", x: 15, y: 90 },
    ],
    edges: [
      { from: "p1", to: "p2" },
      { from: "p2", to: "p3" },
      { from: "p3", to: "p4", label: "SIM" },
      { from: "p3", to: "p5", label: "NÃƒO" },
      { from: "p4", to: "p6" },
      { from: "p6", to: "p7", label: "SIM" },
      { from: "p6", to: "p5", label: "NÃƒO" },
      { from: "p7", to: "p8" },
    ],
    conversation: [
      { from: "system", text: "ğŸ“„ CenÃ¡rio 1: UsuÃ¡rio vÃª todas as 3 pÃ¡ginas" },
      { from: "system", text: "ğŸ“Š 12 resultados para \"esportivo\" apÃ³s refinamento" },
      { from: "elara", text: "Separei as melhores de esportivo ğŸƒ\n[Carrossel com 5 cards]\nEssas sÃ£o as principais! Quer ver mais?\n\n[ Sim, mais ofertas ] [ Outra categoria ] [ Era sÃ³ isso ]" },
      { from: "user", text: "[ Sim, mais ofertas ]" },
      { from: "elara", text: "Mais opÃ§Ãµes de esportivo pra vocÃª:\n[Carrossel com 5 cards]\nQuer ver mais?\n\n[ Sim, mais ofertas ] [ Outra categoria ] [ Era sÃ³ isso ]" },
      { from: "user", text: "[ Sim, mais ofertas ]" },
      { from: "elara", text: "As Ãºltimas opÃ§Ãµes de esportivo:\n[Carrossel com 2 cards]\n\nEsses sÃ£o todos que tenho! Quer refinar a busca ou ver outra categoria?\n\n[ Refinar busca ] [ Outra categoria ] [ Era sÃ³ isso ]" },
      { from: "system", text: "â†’ [ Refinar busca ] â†’ Fluxo: Busca e Resultados\nâ†’ [ Outra categoria ] â†’ Fluxo: ContextualizaÃ§Ã£o\nâ†’ [ Era sÃ³ isso ] â†’ Fluxo: Coleta de NPS (se 3+ interaÃ§Ãµes)" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“„ CenÃ¡rio 2: UsuÃ¡rio para na pÃ¡gina 1" },
      { from: "system", text: "ğŸ“Š 8 resultados para \"moda feminina\"" },
      { from: "elara", text: "Separei as melhores de moda feminina ğŸ‘—\n[Carrossel com 5 cards]\nQuer ver mais?\n\n[ Sim, mais ofertas ] [ Outra categoria ] [ Era sÃ³ isso ]" },
      { from: "user", text: "[ Era sÃ³ isso ]" },
      { from: "system", text: "â†’ Fluxo: ContextualizaÃ§Ã£o (outra categoria) ou Fluxo: Coleta de NPS" },
    ],
  },
  {
    id: "proactive",
    title: "InserÃ§Ã£o Proativa",
    section: "Â§5.8",
    icon: "ğŸ’¡",
    description: "Quando a Elara insere anÃºncios proativamente na conversa",
    nodes: [
      { id: "pr1", type: "system", label: "Momento oportuno\ndetectado\n(localizaÃ§Ã£o, categoria,\nocasiÃ£o)", x: 50, y: 0 },
      { id: "pr2", type: "decision", label: "Existem anÃºncios\nativos RELACIONADOS\nao contexto?", x: 50, y: 16 },
      { id: "pr3", type: "elara", label: "Ponte natural\n+ oferecer carrossel\n[ Sim, mostra! ]\n[ SÃ³ a localizaÃ§Ã£o ]", x: 15, y: 32 },
      { id: "pr4", type: "decision", label: "AnÃºncios no\nMESMO SEGMENTO?", x: 55, y: 32 },
      { id: "pr5", type: "elara", label: "Ponte com segmento\n\"NÃ£o achei da Nike,\nmas tem esportivo\"\n[ Sim! ] [ NÃ£o ]", x: 40, y: 48 },
      { id: "pr6", type: "elara", label: "Resposta normal\nSEM inserÃ§Ã£o\ncomercial\n\"Precisa de mais\nalguma coisa?\"", x: 75, y: 48 },
      { id: "pr7", type: "decision", label: "UsuÃ¡rio\naceitou?", x: 15, y: 50 },
      { id: "pr8", type: "success", label: "Exibir carrossel\nâ†’ Fluxo: Busca\ne Resultados", x: 5, y: 66 },
      { id: "pr9", type: "danger", label: "Respeitar recusa\nNÃƒO insistir\nnesta troca", x: 25, y: 66 },
      { id: "pr10", type: "system", label: "Regras:\nâ€¢ MÃ¡x 1 inserÃ§Ã£o por troca\nâ€¢ Nunca em erro/frustraÃ§Ã£o\nâ€¢ Nunca irrelevante\nâ€¢ PrÃ³xima troca: pode tentar\n  novamente", x: 50, y: 82 },
    ],
    edges: [
      { from: "pr1", to: "pr2" },
      { from: "pr2", to: "pr3", label: "SIM" },
      { from: "pr2", to: "pr4", label: "NÃƒO" },
      { from: "pr4", to: "pr5", label: "SIM" },
      { from: "pr4", to: "pr6", label: "NÃƒO" },
      { from: "pr3", to: "pr7" },
      { from: "pr7", to: "pr8", label: "SIM" },
      { from: "pr7", to: "pr9", label: "NÃƒO" },
    ],
    conversation: [
      { from: "system", text: "ğŸ’¡ CenÃ¡rio 1: PromoÃ§Ã£o direta aceita" },
      { from: "user", text: "Onde fica a Nike?" },
      { from: "system", text: "ğŸ’¡ Momento oportuno: pergunta sobre localizaÃ§Ã£o de loja\nğŸ” Verificando anÃºncios da Nike...\nâœ“ Nike tem 3 promoÃ§Ãµes ativas" },
      { from: "elara", text: "A *Nike* fica no *Bloco 04, Loja 130* ğŸ“\nE olha, ela estÃ¡ com promoÃ§Ãµes agora! Quer ver?\n\n[ Sim, mostra! ] [ SÃ³ a localizaÃ§Ã£o ]" },
      { from: "user", text: "[ Sim, mostra! ]" },
      { from: "elara", text: "A *Nike* estÃ¡ com essas promoÃ§Ãµes agora ğŸ‘Ÿ\n[Carrossel com 3 cards]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ’¡ CenÃ¡rio 2: UsuÃ¡rio recusa promoÃ§Ã£o" },
      { from: "user", text: "Onde fica a Adidas?" },
      { from: "system", text: "ğŸ’¡ Momento oportuno\nâœ“ Adidas tem 2 promoÃ§Ãµes ativas" },
      { from: "elara", text: "A *Adidas* fica no *Bloco 04, Loja 127* ğŸ“\nEla estÃ¡ com promoÃ§Ãµes! Quer ver?\n\n[ Sim, mostra! ] [ SÃ³ a localizaÃ§Ã£o ]" },
      { from: "user", text: "[ SÃ³ a localizaÃ§Ã£o ]" },
      { from: "system", text: "âš ï¸ Recusa respeitada - NÃƒO insistir nesta troca" },
      { from: "elara", text: "Sem problemas! A Adidas fica no Bloco 04, Loja 127. Precisa de mais alguma coisa?" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ’¡ CenÃ¡rio 3: Sem promoÃ§Ãµes â†’ resposta normal" },
      { from: "user", text: "Onde fica a Havaianas?" },
      { from: "system", text: "ğŸ’¡ Verificando anÃºncios...\nâŒ Sem anÃºncios ativos e sem segmento prÃ³ximo" },
      { from: "elara", text: "A *Havaianas* fica no *Bloco 02, Loja 45* ğŸ“\nPrecisa de mais alguma coisa?\n\n[ Ver promoÃ§Ãµes ] [ Outra loja ] [ Era sÃ³ isso ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ’¡ CenÃ¡rio 4: Sem anÃºncio direto, mas segmento tem" },
      { from: "user", text: "Onde fica a Asics?" },
      { from: "system", text: "ğŸ’¡ Verificando anÃºncios Asics...\nâŒ Sem anÃºncio direto\nğŸ” Segmento esportivo tem promoÃ§Ãµes? SIM" },
      { from: "elara", text: "A *Asics* fica no *Bloco 03, Loja 89* ğŸ“\nNÃ£o achei promoÃ§Ãµes da Asics, mas tem ofertas de *esportivo* que podem te interessar!\n\n[ Sim, mostra! ] [ NÃ£o, obrigado ]" },
      { from: "user", text: "[ Sim, mostra! ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
    ],
  },
  {
    id: "bridge",
    title: "Ponte Comercial",
    section: "Â§8.1",
    icon: "ğŸŒ‰",
    description: "Ponte comercial apÃ³s respostas informacionais (horÃ¡rio, estacionamento)",
    nodes: [
      { id: "b1", type: "user", label: "Pergunta\ninformacional\n(horÃ¡rio, estac.)", x: 50, y: 0 },
      { id: "b2", type: "elara", label: "Responder a\npergunta\ncompletamente\n(Prioridade 3)", x: 50, y: 14 },
      { id: "b3", type: "decision", label: "Tema Ã©\nSENSÃVEL?\n(acessibilidade,\nseguranÃ§a...)", x: 50, y: 29 },
      { id: "b4", type: "danger", label: "NÃƒO fazer ponte\nFoco 100% no problema\n\"Como posso ajudar\nmais com isso?\"", x: 85, y: 29 },
      { id: "b5", type: "decision", label: "AnÃºncio\nrelacionado\nao tema?\nâ†’ Fluxo: RotaÃ§Ã£o\ne Fadiga", x: 50, y: 44 },
      { id: "b6", type: "elara", label: "Ponte direta:\n\"A propÃ³sito, o\nSpoleto tem combo\nespecial! Quer ver?\"", x: 10, y: 59 },
      { id: "b7", type: "elara", label: "Ponte adjacente:\n\"Tem restaurantes com\npromoÃ§Ãµes na praÃ§a!\nQuer ver?\"", x: 35, y: 59 },
      { id: "b8", type: "elara", label: "CTA genÃ©rico:\n\"Posso te mostrar\npromoÃ§Ãµes ou ajudar\na encontrar loja ğŸ˜‰\"\n[ PromoÃ§Ãµes ] [ Loja ] [ SÃ³ isso ]", x: 60, y: 59 },
      { id: "b9", type: "elara", label: "CTA informacional:\n\"Posso ajudar\ncom mais alguma\ncoisa?\"\n[ Loja ] [ Mapa ] [ SÃ³ isso ]", x: 85, y: 59 },
      { id: "b10", type: "system", label: "Regra: apenas 1 mecanismo\npor mensagem\n(proativa OU ponte,\nnunca ambos)", x: 50, y: 80 },
    ],
    edges: [
      { from: "b1", to: "b2" },
      { from: "b2", to: "b3" },
      { from: "b3", to: "b4", label: "SIM" },
      { from: "b3", to: "b5", label: "NÃƒO" },
      { from: "b5", to: "b6", label: "Direto" },
      { from: "b5", to: "b7", label: "Adjacente" },
      { from: "b5", to: "b8", label: "Nenhum\nrelacionado" },
      { from: "b5", to: "b9", label: "ZERO\nanÃºncios" },
    ],
    conversation: [
      { from: "user", text: "Onde fica a praÃ§a de alimentaÃ§Ã£o?" },
      { from: "elara", text: "A praÃ§a de alimentaÃ§Ã£o fica no *Bloco 06* ğŸ½ï¸\n\nE por falar nisso, tem restaurantes com promoÃ§Ãµes na praÃ§a! Quer ver?\n\n[ Sim, mostra! ] [ NÃ£o, obrigado ]" },
      { from: "system", text: "â†’ [ Sim, mostra! ] â†’ Fluxo: Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Perdi minha crianÃ§a, preciso de ajuda!" },
      { from: "system", text: "âš ï¸ Tema SENSÃVEL detectado â†’ NÃƒO fazer ponte comercial" },
      { from: "elara", text: "Entendo sua preocupaÃ§Ã£o! Dirija-se imediatamente Ã  administraÃ§Ã£o do Outlet, no *Bloco 01* ğŸ“\n\nA equipe de seguranÃ§a pode ajudar a localizar sua crianÃ§a. Posso te passar o telefone da administraÃ§Ã£o?" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸŒ‰ CenÃ¡rio 3: Ponte direta (anÃºncio exato)" },
      { from: "user", text: "Tem restaurante bom na praÃ§a?" },
      { from: "system", text: "ğŸŒ‰ Responder pergunta + anÃºncio DIRETO relacionado" },
      { from: "elara", text: "Sim, a praÃ§a tem vÃ¡rias opÃ§Ãµes! A propÃ³sito, o *Spoleto* estÃ¡ com combo especial agora ğŸ\nQuer ver?\n\n[ Sim, mostra! ] [ NÃ£o, obrigado ]" },
      { from: "user", text: "[ Sim, mostra! ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸŒ‰ CenÃ¡rio 4: CTA genÃ©rico (sem anÃºncio relacionado)" },
      { from: "user", text: "Qual o horÃ¡rio do outlet?" },
      { from: "system", text: "ğŸŒ‰ Pergunta informacional\nâŒ Sem anÃºncios relacionados ao tema\nâ†’ CTA genÃ©rico" },
      { from: "elara", text: "*HorÃ¡rio hoje:*\nğŸ• 9h Ã s 21h\n\nPosso te mostrar promoÃ§Ãµes ou ajudar a encontrar uma loja ğŸ˜‰\n\n[ PromoÃ§Ãµes ] [ Encontrar loja ] [ Era sÃ³ isso ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸŒ‰ CenÃ¡rio 5: CTA informacional (ZERO anÃºncios)" },
      { from: "user", text: "Onde estacionar?" },
      { from: "system", text: "ğŸŒ‰ Pergunta informacional\nâŒ ZERO anÃºncios no outlet\nâ†’ CTA informacional" },
      { from: "elara", text: "O estacionamento fica na entrada principal, com acesso pelo Bloco 01 ğŸ…¿ï¸\n\nPosso ajudar com mais alguma coisa?\n\n[ Encontrar loja ] [ Ver mapa ] [ Era sÃ³ isso ]" },
    ],
  },
  {
    id: "fatigue",
    title: "RotaÃ§Ã£o e Fadiga",
    section: "Â§5.9",
    icon: "ğŸ”„",
    description: "Controle de frequÃªncia e rotaÃ§Ã£o de anÃºncios por usuÃ¡rio",
    nodes: [
      { id: "fa1", type: "system", label: "AnÃºncio candidato\na exibiÃ§Ã£o", x: 50, y: 0 },
      { id: "fa2", type: "decision", label: "UsuÃ¡rio pediu\nexplicitamente\npara ver de novo?", x: 50, y: 14 },
      { id: "fa3", type: "success", label: "Exibir mesmo\nque exceda\nlimites\n(exceÃ§Ã£o)", x: 85, y: 14 },
      { id: "fa4", type: "decision", label: "Limites de\nfrequÃªncia:\n1x/conversa\n2x/dia, 4x/7dias?", x: 50, y: 30 },
      { id: "fa5", type: "success", label: "OK exibir\nâ†’ Fluxo: Busca\ne Resultados", x: 20, y: 30 },
      { id: "fa6", type: "decision", label: "Existem outros\nanÃºncios NÃƒO\nvistos?", x: 50, y: 46 },
      { id: "fa7", type: "elara", label: "Substituir por\nanÃºncios nÃ£o vistos", x: 30, y: 60 },
      { id: "fa8", type: "system", label: "NÃ£o exibir anÃºncio\nâ†’ Fluxo: ApresentaÃ§Ã£o\nde Lojas (Prioridade 2)\nou Fluxo: Ponte\nComercial (Prioridade 3)", x: 70, y: 60 },
      { id: "fa9", type: "tracking", label: "Limites:\nâ€¢ Mesmo anÃºncio: 1x/conversa\nâ€¢ Mesmo anÃºncio: 2x/dia\nâ€¢ Mesmo anÃºncio: 4x/7dias\nâ€¢ Mesma loja: 3 anÃºncios\n  diferentes/conversa", x: 50, y: 80 },
    ],
    edges: [
      { from: "fa1", to: "fa2" },
      { from: "fa2", to: "fa3", label: "SIM" },
      { from: "fa2", to: "fa4", label: "NÃƒO" },
      { from: "fa4", to: "fa5", label: "Dentro\ndo limite" },
      { from: "fa4", to: "fa6", label: "Excedeu\nlimite" },
      { from: "fa6", to: "fa7", label: "SIM" },
      { from: "fa6", to: "fa8", label: "NÃƒO" },
    ],
    conversation: [
      { from: "system", text: "ğŸ“Š Verificando limites para anÃºncio Nike #12:\nâ€¢ Exibido 1x nesta conversa âŒ (limite: 1x)\nâ€¢ Exibido 1x hoje âœ“\nâ€¢ Exibido 2x em 7 dias âœ“" },
      { from: "system", text: "âš ï¸ Limite atingido! Buscando substitutos..." },
      { from: "system", text: "âœ“ Adidas #7 e Puma #3 nÃ£o vistos â†’ substituir\nâ†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 2: Limite excedido, com substitutos" },
      { from: "user", text: "Me mostra aquela promoÃ§Ã£o da Nike de novo" },
      { from: "system", text: "âœ“ Pedido EXPLÃCITO â†’ exceÃ§Ã£o de fadiga ativada" },
      { from: "elara", text: "Claro! Aqui estÃ¡ a promoÃ§Ã£o da *Nike*:\n[Card do anÃºncio Nike #12]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ”„ CenÃ¡rio 3: Limite excedido, sem substitutos" },
      { from: "system", text: "ğŸ“Š Verificando: todos os anÃºncios esportivos jÃ¡ foram vistos\nâŒ Limite atingido + sem substitutos\nâ†’ NÃ£o exibir anÃºncio" },
      { from: "system", text: "â†’ Fluxo: ApresentaÃ§Ã£o de Lojas (Prioridade 2) ou Fluxo: Ponte Comercial" },
    ],
  },
  {
    id: "stores",
    title: "ApresentaÃ§Ã£o de Lojas",
    section: "Â§7",
    icon: "ğŸª",
    description: "Como a Elara apresenta lojas (priorizando anunciantes)",
    nodes: [
      { id: "st1", type: "user", label: "UsuÃ¡rio busca\nlojas (nÃ£o promoÃ§Ãµes)", x: 50, y: 0 },
      { id: "st2", type: "decision", label: "Busca direta\n(1 loja) ou\ncategoria?", x: 50, y: 14 },
      { id: "st3", type: "decision", label: "LOJA ÃšNICA:\nTem anÃºncio ativo?", x: 20, y: 30 },
      { id: "st4", type: "elara", label: "LocalizaÃ§Ã£o +\n\"Quer ver as\npromoÃ§Ãµes?\"", x: 8, y: 46 },
      { id: "st5", type: "decision", label: "HÃ¡ anÃºncios\nno segmento?", x: 32, y: 46 },
      { id: "st6", type: "elara", label: "LocalizaÃ§Ã£o +\n\"Mas tenho promoÃ§Ãµes\nde segmento.\nQuer ver?\"", x: 22, y: 62 },
      { id: "st7", type: "elara", label: "LocalizaÃ§Ã£o +\n\"Se for atÃ© a loja,\npode encontrar\nalgo especial!\"", x: 40, y: 62 },
      { id: "st8", type: "decision", label: "LISTA:\nAlguma loja tem\nanÃºncio?", x: 75, y: 30 },
      { id: "st9", type: "elara", label: "Anunciantes PRIMEIRO\ncom â­ + CTA promoÃ§Ãµes\n\"Quer ver promoÃ§Ãµes\nda Nike ou Adidas?\"", x: 62, y: 46 },
      { id: "st10", type: "elara", label: "Lista normal +\n\"Quer saber mais\nde alguma?\"", x: 88, y: 46 },
      { id: "st11", type: "system", label: "Limite: mÃ¡x 5 lojas\nSe > 5: priorizar\nanunciantes + \"Ver mais?\"", x: 75, y: 65 },
    ],
    edges: [
      { from: "st1", to: "st2" },
      { from: "st2", to: "st3", label: "1 loja" },
      { from: "st2", to: "st8", label: "Categoria" },
      { from: "st3", to: "st4", label: "SIM" },
      { from: "st3", to: "st5", label: "NÃƒO" },
      { from: "st5", to: "st6", label: "SIM" },
      { from: "st5", to: "st7", label: "NÃƒO" },
      { from: "st8", to: "st9", label: "SIM" },
      { from: "st8", to: "st10", label: "NÃƒO" },
      { from: "st9", to: "st11" },
      { from: "st10", to: "st11" },
    ],
    conversation: [
      { from: "system", text: "ğŸª CenÃ¡rio 1: Lista de lojas por categoria" },
      { from: "user", text: "Quais lojas de moda esportiva?" },
      { from: "system", text: "ğŸª Categoria: esportiva\nğŸ“Š 5 lojas encontradas, 2 com promoÃ§Ãµes â†’ anunciantes primeiro" },
      { from: "elara", text: "Achei essas lojas de *moda esportiva* ğŸƒ\n\nâ€¢ â­ *Nike*, Bloco 04, Loja 130 (com promoÃ§Ãµes!)\nâ€¢ â­ *Adidas*, Bloco 04, Loja 127 (com promoÃ§Ãµes!)\nâ€¢ *Asics*, Bloco 03, Loja 89\n\nQuer ver as promoÃ§Ãµes da Nike ou Adidas?\n\n[ PromoÃ§Ãµes Nike ] [ PromoÃ§Ãµes Adidas ] [ Saber mais ]" },
      { from: "system", text: "â†’ [ PromoÃ§Ãµes Nike/Adidas ] â†’ Fluxo: Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸª CenÃ¡rio 2: Loja Ãºnica COM promoÃ§Ã£o" },
      { from: "user", text: "Onde fica a Swarovski?" },
      { from: "system", text: "ğŸª Loja Ãºnica: Swarovski\nâœ“ Tem anÃºncio ativo â†’ oferecer promoÃ§Ãµes" },
      { from: "elara", text: "A *Swarovski* fica no *Bloco 02, Loja 55* ğŸ“\nE ela estÃ¡ com promoÃ§Ãµes especiais! Quer ver?\n\n[ Ver promoÃ§Ãµes ] [ SÃ³ a localizaÃ§Ã£o ]" },
      { from: "system", text: "â†’ [ Ver promoÃ§Ãµes ] â†’ Fluxo: Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸª CenÃ¡rio 3: Loja Ãºnica SEM promoÃ§Ã£o, mas segmento tem" },
      { from: "user", text: "Onde fica a Asics?" },
      { from: "system", text: "ğŸª Loja Ãºnica: Asics\nâŒ Sem anÃºncio ativo\nğŸ” Segmento esportivo tem promoÃ§Ãµes â†’ oferecer" },
      { from: "elara", text: "A *Asics* fica no *Bloco 03, Loja 89* ğŸ“\nEla nÃ£o estÃ¡ com promoÃ§Ãµes agora, mas tem ofertas no segmento esportivo. Quer ver?\n\n[ Ver esportivo ] [ SÃ³ a localizaÃ§Ã£o ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸª CenÃ¡rio 4: Loja SEM promoÃ§Ã£o, segmento SEM promoÃ§Ã£o" },
      { from: "user", text: "Onde fica a Melissa?" },
      { from: "system", text: "ğŸª Loja Ãºnica: Melissa\nâŒ Sem anÃºncio ativo\nâŒ Segmento calÃ§ados sem promoÃ§Ãµes â†’ mensagem motivacional" },
      { from: "elara", text: "A *Melissa* fica no *Bloco 03, Loja 78* ğŸ“\nEla nÃ£o estÃ¡ com promoÃ§Ãµes no momento, mas se for atÃ© a loja, pode encontrar algo especial!\n\nPrecisa de mais alguma coisa?\n\n[ Ver lojas ] [ PromoÃ§Ãµes ] [ Era sÃ³ isso ]" },
    ],
  },
  {
    id: "reengagement",
    title: "Reengajamento",
    section: "Â§17.2",
    icon: "â°",
    description: "Comportamento da Elara durante inatividade do usuÃ¡rio",
    nodes: [
      { id: "r1", type: "system", label: "Inatividade\ndetectada", x: 50, y: 0 },
      { id: "r2", type: "decision", label: "Quanto\ntempo?", x: 50, y: 12 },
      { id: "r3", type: "decision", label: "5 MIN:\nExiste contexto\nda conversa?", x: 25, y: 26 },
      { id: "r4", type: "decision", label: "5 MIN PÃ“S-TERMOS:\nExistem anÃºncios\ndisponÃ­veis?", x: 75, y: 26 },
      { id: "r5", type: "decision", label: "AnÃºncios NÃƒO VISTOS\nno segmento?\nâ†’ Fluxo: RotaÃ§Ã£o\ne Fadiga", x: 15, y: 42 },
      { id: "r6", type: "elara", label: "Oferta contextual:\n\"Achei mais ofertas\nde esportivo ğŸƒ\"\n+ carrossel (3 cards)", x: 5, y: 58 },
      { id: "r7", type: "decision", label: "Fadiga?", x: 30, y: 42 },
      { id: "r8", type: "elara", label: "Informacional:\n\"Posso ajudar com\nmais alguma coisa?\"\n[ PromoÃ§Ãµes ] [ Loja ] [ Pronto ]", x: 30, y: 58 },
      { id: "r9", type: "elara", label: "Com anÃºncios:\n\"DÃ¡ uma olhada nas\npromoÃ§Ãµes â­\"\n[ PromoÃ§Ãµes ] [ Loja ] [ HorÃ¡rio ]", x: 65, y: 42 },
      { id: "r10", type: "elara", label: "Sem anÃºncios:\n\"Posso ajudar a\nencontrar lojas ğŸ˜Š\"\n[ Loja ] [ Mapa ] [ HorÃ¡rio ]", x: 87, y: 42 },
      { id: "r11", type: "danger", label: "10 MIN (qualquer):\n\"Vou encerrar por aqui,\nmais Ã© sÃ³ me chamar ğŸ˜Š\"\n[ Voltar Ã s promoÃ§Ãµes ]\n[ Ver lojas ]", x: 50, y: 78 },
      { id: "r12", type: "system", label: "Nova mensagem\ndo usuÃ¡rio\nâ†’ Fluxo: GestÃ£o\nde Contexto\n(sem repetir greeting\nou termos)", x: 50, y: 93 },
    ],
    edges: [
      { from: "r1", to: "r2" },
      { from: "r2", to: "r3", label: "5 min\n(com conversa)" },
      { from: "r2", to: "r4", label: "5 min\n(pÃ³s-termos)" },
      { from: "r2", to: "r11", label: "10 min" },
      { from: "r3", to: "r5", label: "SIM" },
      { from: "r3", to: "r4", label: "NÃƒO" },
      { from: "r5", to: "r6", label: "SIM" },
      { from: "r5", to: "r7", label: "NÃƒO" },
      { from: "r7", to: "r8", label: "SIM" },
      { from: "r7", to: "r6", label: "NÃƒO" },
      { from: "r4", to: "r9", label: "SIM" },
      { from: "r4", to: "r10", label: "NÃƒO" },
      { from: "r11", to: "r12" },
    ],
    conversation: [
      { from: "system", text: "â° CenÃ¡rio 1: 5min com contexto + ofertas do segmento" },
      { from: "system", text: "â° 5 minutos de inatividade detectados\nContexto: buscou \"esportivo\" anteriormente\nğŸ” AnÃºncios nÃ£o vistos no segmento? SIM" },
      { from: "elara", text: "Enquanto isso, achei mais ofertas de *esportivo* que podem te interessar ğŸƒ\n[Carrossel com 3 cards]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â° CenÃ¡rio 2: 5min pÃ³s-termos + com anÃºncios" },
      { from: "system", text: "â° 5 minutos de inatividade\nContexto: aceitou termos mas nÃ£o interagiu\nğŸ” AnÃºncios disponÃ­veis? SIM" },
      { from: "elara", text: "DÃ¡ uma olhada nas promoÃ§Ãµes do Outlet â­\n\n[ PromoÃ§Ãµes ] [ Encontrar loja ] [ HorÃ¡rio ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â° CenÃ¡rio 3: 5min pÃ³s-termos + sem anÃºncios" },
      { from: "system", text: "â° 5 minutos de inatividade\nContexto: aceitou termos mas nÃ£o interagiu\nâŒ ZERO anÃºncios disponÃ­veis" },
      { from: "elara", text: "Posso ajudar a encontrar lojas ou informaÃ§Ãµes sobre o Outlet ğŸ˜Š\n\n[ Encontrar loja ] [ Ver mapa ] [ HorÃ¡rio ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â° CenÃ¡rio 4: 10min timeout" },
      { from: "system", text: "â° 10 minutos de inatividade total" },
      { from: "elara", text: "Vou encerrar nossa conversa por aqui, mas Ã© sÃ³ me chamar quando precisar ğŸ˜Š\n\n[ Voltar Ã s promoÃ§Ãµes ] [ Ver lojas ]" },
      { from: "system", text: "â†’ [ Voltar Ã s promoÃ§Ãµes ] â†’ Fluxo: Busca e Resultados\nâ†’ [ Ver lojas ] â†’ Fluxo: ApresentaÃ§Ã£o de Lojas\nâ†’ Nova mensagem â†’ Fluxo: GestÃ£o de Contexto" },
    ],
  },
  {
    id: "restrictions",
    title: "RestriÃ§Ãµes de ConteÃºdo",
    section: "Â§18",
    icon: "ğŸš«",
    description: "Temas e comportamentos proibidos para a Elara",
    nodes: [
      { id: "x1", type: "user", label: "Mensagem do\nusuÃ¡rio", x: 50, y: 0 },
      { id: "x2", type: "decision", label: "Tema\nproibido?", x: 50, y: 14 },
      { id: "x3", type: "danger", label: "PolÃ­tica / ReligiÃ£o\nâ†’ Recusar educadamente\n+ redirecionar", x: 10, y: 32 },
      { id: "x4", type: "danger", label: "Outros shoppings\n/ concorrentes\nâ†’ \"SÃ³ ajudo com\no Outlet Premium\"", x: 30, y: 32 },
      { id: "x5", type: "danger", label: "OpiniÃµes sobre\nmarcas\nâ†’ \"NÃ£o dou opiniÃ£o,\nmas posso mostrar\"", x: 50, y: 32 },
      { id: "x6", type: "danger", label: "Info mÃ©dica /\njurÃ­dica / financeira\nâ†’ \"Consulte um\nprofissional\"", x: 70, y: 32 },
      { id: "x7", type: "danger", label: "ProvocaÃ§Ãµes /\ninsultos\nâ†’ Ignorar e\nredirecionar", x: 90, y: 32 },
      { id: "x8", type: "elara", label: "Resposta padrÃ£o:\n1. Educada e breve\n2. Redirecionar ao\n   escopo do Outlet\n3. NUNCA ignorar\n   em silÃªncio", x: 50, y: 52 },
      { id: "x9", type: "elara", label: "\"NÃ£o consigo te\najudar com isso,\nmas posso te mostrar\nas promoÃ§Ãµes! â­\"\n[ PromoÃ§Ãµes ] [ Loja ] [ HorÃ¡rio ]", x: 50, y: 72 },
      { id: "x10", type: "system", label: "Comportamentos proibidos:\nâ€¢ NÃ£o se identificar como humana\nâ€¢ NÃ£o revelar dados tÃ©cnicos\nâ€¢ NÃ£o prometer preÃ§os nÃ£o\n  confirmados\nâ€¢ NÃ£o enviar links externos\nâ€¢ NÃ£o coletar dados sensÃ­veis", x: 50, y: 90 },
    ],
    edges: [
      { from: "x1", to: "x2" },
      { from: "x2", to: "x3", label: "PolÃ­tica" },
      { from: "x2", to: "x4", label: "Concorrente" },
      { from: "x2", to: "x5", label: "OpiniÃ£o" },
      { from: "x2", to: "x6", label: "MÃ©dico/\nJurÃ­dico" },
      { from: "x2", to: "x7", label: "Ofensivo" },
      { from: "x3", to: "x8" },
      { from: "x4", to: "x8" },
      { from: "x5", to: "x8" },
      { from: "x6", to: "x8" },
      { from: "x7", to: "x8" },
      { from: "x8", to: "x9" },
    ],
    conversation: [
      { from: "user", text: "O que vocÃª acha da situaÃ§Ã£o polÃ­tica do paÃ­s?" },
      { from: "system", text: "ğŸš« Tema PROIBIDO: polÃ­tica" },
      { from: "elara", text: "NÃ£o consigo te ajudar com isso, mas posso te mostrar as novidades do Outlet! Quer ver as promoÃ§Ãµes de hoje? â­\n\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ] [ HorÃ¡rio ]" },
      { from: "system", text: "â†’ [ Ver promoÃ§Ãµes ] â†’ Fluxo: Busca e Resultados\nâ†’ [ Encontrar loja ] â†’ Fluxo: ApresentaÃ§Ã£o de Lojas" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "user", text: "Qual shopping Ã© melhor, vocÃªs ou o Catarina?" },
      { from: "system", text: "ğŸš« Tema PROIBIDO: concorrente" },
      { from: "elara", text: "Eu sou a assistente do Outlet Premium SÃ£o Paulo e sÃ³ consigo te ajudar com informaÃ§Ãµes daqui ğŸ˜‰\n\nPosso te mostrar as promoÃ§Ãµes ou ajudar a encontrar uma loja?" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸš« CenÃ¡rio 3: OpiniÃ£o sobre marcas" },
      { from: "user", text: "A Nike Ã© melhor que a Adidas?" },
      { from: "system", text: "ğŸš« Tema restrito: opiniÃ£o sobre marcas" },
      { from: "elara", text: "NÃ£o dou opiniÃ£o sobre marcas, mas posso te mostrar promoÃ§Ãµes de ambas! Quer ver?\n\n[ PromoÃ§Ãµes Nike ] [ PromoÃ§Ãµes Adidas ] [ Outra marca ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸš« CenÃ¡rio 4: Info mÃ©dica/jurÃ­dica" },
      { from: "user", text: "Passei mal, o que devo tomar?" },
      { from: "system", text: "ğŸš« Tema restrito: info mÃ©dica â†’ redirecionar para profissional" },
      { from: "elara", text: "Sinto muito que nÃ£o estÃ¡ se sentindo bem! Recomendo procurar a administraÃ§Ã£o no *Bloco 01* para assistÃªncia. Eles podem ajudar a encontrar atendimento.\n\nPosso te ajudar com mais alguma coisa?" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸš« CenÃ¡rio 5: ProvocaÃ§Ã£o" },
      { from: "user", text: "VocÃª Ã© uma IA inÃºtil" },
      { from: "system", text: "ğŸš« ProvocaÃ§Ã£o detectada â†’ ignorar e redirecionar" },
      { from: "elara", text: "Estou aqui pra ajudar! Posso te mostrar promoÃ§Ãµes ou ajudar a encontrar uma loja ğŸ˜Š\n\n[ Ver promoÃ§Ãµes ] [ Encontrar loja ] [ HorÃ¡rio ]" },
    ],
  },
  {
    id: "nps",
    title: "Coleta de NPS",
    section: "Â§16",
    icon: "â­",
    description: "Pesquisa de satisfaÃ§Ã£o ao final de conversas",
    nodes: [
      { id: "n1", type: "system", label: "Conversa com\n3+ interaÃ§Ãµes\nchegando ao fim", x: 50, y: 0 },
      { id: "n2", type: "decision", label: "Conversa foi\nde erro/fallback?", x: 50, y: 16 },
      { id: "n3", type: "system", label: "NÃƒO enviar NPS\nem conversas\nde erro\nâ†’ Fluxo: Reengajamento\n(encerrar)", x: 85, y: 16 },
      { id: "n4", type: "elara", label: "\"De 0 a 10, quÃ£o\nÃºtil foi a Elara hoje?\"\n[ 0-3 ] [ 4-6 ] [ 7-8 ] [ 9-10 ]", x: 50, y: 34 },
      { id: "n5", type: "decision", label: "Nota?", x: 50, y: 50 },
      { id: "n6", type: "elara", label: "0-6 (Detratores):\n\"O que poderia\nser melhor?\"\n(campo aberto)", x: 20, y: 66 },
      { id: "n7", type: "elara", label: "7-8 (Neutros):\nAgradecimento", x: 50, y: 66 },
      { id: "n8", type: "elara", label: "9-10 (Promotores):\nAgradecimento", x: 80, y: 66 },
      { id: "n9", type: "system", label: "Se ignorou:\nNÃƒO reenviar\nMÃ¡x 1 coleta/sessÃ£o", x: 50, y: 84 },
    ],
    edges: [
      { from: "n1", to: "n2" },
      { from: "n2", to: "n3", label: "SIM" },
      { from: "n2", to: "n4", label: "NÃƒO" },
      { from: "n4", to: "n5" },
      { from: "n5", to: "n6", label: "0-6" },
      { from: "n5", to: "n7", label: "7-8" },
      { from: "n5", to: "n8", label: "9-10" },
    ],
    conversation: [
      { from: "system", text: "â­ CenÃ¡rio 1: Detrator (nota baixa)" },
      { from: "system", text: "âœ“ Conversa com 5 interaÃ§Ãµes, nÃ£o foi erro" },
      { from: "elara", text: "De 0 a 10, quÃ£o Ãºtil foi a Elara hoje?\n\n[ 0-3 ] [ 4-6 ] [ 7-8 ] [ 9-10 ]" },
      { from: "user", text: "[ 0-3 ]" },
      { from: "elara", text: "Puxa, sinto muito! O que poderia ser melhor?" },
      { from: "user", text: "NÃ£o encontrei o que procurava" },
      { from: "system", text: "âœ“ Nota 2 + comentÃ¡rio armazenados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â­ CenÃ¡rio 2: Promotor (nota alta)" },
      { from: "elara", text: "De 0 a 10, quÃ£o Ãºtil foi a Elara hoje?\n\n[ 0-3 ] [ 4-6 ] [ 7-8 ] [ 9-10 ]" },
      { from: "user", text: "[ 9-10 ]" },
      { from: "elara", text: "Que bom que pude ajudar! ğŸ‰ Obrigada pela avaliaÃ§Ã£o. Volte sempre!" },
      { from: "system", text: "âœ“ Nota 10 armazenada" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â­ CenÃ¡rio 3: Conversa de erro â†’ NÃƒO envia NPS" },
      { from: "system", text: "âŒ Conversa foi de erro/fallback â†’ NÃƒO enviar NPS\nâ†’ Segue para: Fluxo Reengajamento (encerrar)" },
    ],
  },
  {
    id: "context",
    title: "GestÃ£o de Contexto",
    section: "Â§12, Â§13",
    icon: "ğŸ§ ",
    description: "PersistÃªncia de contexto, anti-loop e progressÃ£o obrigatÃ³ria",
    nodes: [
      { id: "c1", type: "user", label: "Nova mensagem\ndo usuÃ¡rio", x: 50, y: 0 },
      { id: "c2", type: "decision", label: "Tem referÃªncia\nexplÃ­cita ao\ncontexto anterior?\n(\"dessas\", \"essa loja\")", x: 50, y: 14 },
      { id: "c3", type: "success", label: "Manter contexto\ninterpretar referÃªncia\n\"Ok, promoÃ§Ãµes de\ntÃªnis na Adidas!\"", x: 20, y: 30 },
      { id: "c4", type: "decision", label: "Intervalo\n< 3 min E\nintenÃ§Ã£o\ncompatÃ­vel?", x: 65, y: 30 },
      { id: "c5", type: "system", label: "RESET contexto\n(pergunta institucional,\nexploratÃ³ria, ou\n> 5 min com\nmudanÃ§a de tema)", x: 85, y: 46 },
      { id: "c6", type: "decision", label: "Ambiguidade:\nnÃ£o tem certeza\nda intenÃ§Ã£o?\nâ†’ Fluxo: ContextualizaÃ§Ã£o", x: 50, y: 46 },
      { id: "c7", type: "elara", label: "PERGUNTAR:\n\"VocÃª quer buscar\nlojas ou promoÃ§Ãµes?\"\n(perguntar > errar)", x: 50, y: 62 },
      { id: "c8", type: "danger", label: "ANTI-LOOP (Â§13):\nâ€¢ Nunca refazer mesma\n  pergunta\nâ€¢ Nunca repetir mesmo\n  bloco de conteÃºdo\nâ€¢ Sempre AVANÃ‡AR", x: 50, y: 80 },
    ],
    edges: [
      { from: "c1", to: "c2" },
      { from: "c2", to: "c3", label: "SIM" },
      { from: "c2", to: "c4", label: "NÃƒO" },
      { from: "c4", to: "c3", label: "SIM" },
      { from: "c4", to: "c6", label: "NÃƒO claro" },
      { from: "c4", to: "c5", label: "Reset" },
      { from: "c6", to: "c7", label: "SIM" },
    ],
    conversation: [
      { from: "user", text: "Quero ver promoÃ§Ãµes de tÃªnis" },
      { from: "elara", text: "[Carrossel de tÃªnis]" },
      { from: "user", text: "E na Adidas?" },
      { from: "system", text: "ğŸ§  ReferÃªncia implÃ­cita: \"na Adidas\" â†’ manter contexto de tÃªnis" },
      { from: "elara", text: "Ok, promoÃ§Ãµes de tÃªnis na *Adidas*!\n[Carrossel filtrado]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "â° 6 minutos depois..." },
      { from: "user", text: "Quais lojas tem aqui?" },
      { from: "system", text: "ğŸ§  RESET: pergunta institucional + intervalo > 5min + tema mudou" },
      { from: "elara", text: "O Outlet tem mais de 100 lojas! O que te interessa?\n\n[ Moda ] [ Esportivo ] [ AlimentaÃ§Ã£o ] [ Ver todas ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ§  CenÃ¡rio 3: Ambiguidade - perguntar" },
      { from: "user", text: "Quero ver opÃ§Ãµes" },
      { from: "system", text: "ğŸ§  IntenÃ§Ã£o ambÃ­gua: \"opÃ§Ãµes\" de quÃª?\nâ†’ Fluxo: ContextualizaÃ§Ã£o - PERGUNTAR" },
      { from: "elara", text: "Claro! VocÃª quer ver opÃ§Ãµes de lojas ou de promoÃ§Ãµes?\n\n[ Lojas ] [ PromoÃ§Ãµes ]" },
      { from: "user", text: "[ PromoÃ§Ãµes ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
    ],
  },
  {
    id: "contextualization",
    title: "ContextualizaÃ§Ã£o",
    section: "Â§1.3",
    icon: "ğŸ¯",
    description: "Quando perguntar antes de responder vs ir direto ao resultado",
    nodes: [
      { id: "ctx1", type: "user", label: "UsuÃ¡rio faz busca\nvaga ou ambÃ­gua", x: 50, y: 0 },
      { id: "ctx2", type: "decision", label: "IntenÃ§Ã£o clara\ne â‰¤ 5 resultados?", x: 50, y: 14 },
      { id: "ctx3", type: "success", label: "Ir DIRETO\nao resultado\nâ†’ Fluxo: Busca\ne Resultados", x: 80, y: 14 },
      { id: "ctx4", type: "decision", label: "Perfil persistente\ntem dados relevantes?\nâ†’ Fluxo: Perfil\ncomo Atalho", x: 50, y: 30 },
      { id: "ctx5", type: "elara", label: "PERFIL RICO (3+ visitas):\nIr direto personalizado\n\"Separei opÃ§Ãµes que\ncombinam com seu gosto â­\"", x: 15, y: 44 },
      { id: "ctx6", type: "elara", label: "PERFIL BÃSICO:\nSugerir + confirmar\n\"Da Ãºltima vez vocÃª viu\nacessÃ³rios. Parecidos?\"\n[ Sim! ] [ Outra categoria ]", x: 50, y: 44 },
      { id: "ctx7", type: "elara", label: "PERFIL NOVO:\nContextualizar\n\"Para quem seria?\"\n[ Mulher ] [ Homem ]\n[ CrianÃ§a ]", x: 85, y: 44 },
      { id: "ctx8", type: "system", label: "Regras:\nâ€¢ MÃ¡x 1 pergunta antes\n  do resultado\nâ€¢ Usar botÃµes (nunca\n  campo aberto)\nâ€¢ Se ignorar, seguir\n  texto livre (Â§14.5)", x: 50, y: 68 },
    ],
    edges: [
      { from: "ctx1", to: "ctx2" },
      { from: "ctx2", to: "ctx3", label: "SIM" },
      { from: "ctx2", to: "ctx4", label: "NÃƒO" },
      { from: "ctx4", to: "ctx5", label: "Rico" },
      { from: "ctx4", to: "ctx6", label: "BÃ¡sico" },
      { from: "ctx4", to: "ctx7", label: "Novo" },
    ],
    conversation: [
      { from: "system", text: "ğŸ¯ CenÃ¡rio 1: Perfil NOVO â†’ contextualizar" },
      { from: "user", text: "Quero um presente" },
      { from: "system", text: "ğŸ¯ IntenÃ§Ã£o vaga: \"presente\" sem contexto\nğŸ” Perfil: NOVO (primeira visita)" },
      { from: "elara", text: "Ã“tima ideia! Para quem seria o presente?\n\n[ Mulher ] [ Homem ] [ CrianÃ§a ]" },
      { from: "user", text: "[ Mulher ]" },
      { from: "elara", text: "Separei opÃ§Ãµes de presentes femininos â­\n[Carrossel com 5 cards: Swarovski, Pandora, Sephora]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados (exibiÃ§Ã£o + tracking)" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 2: Perfil BÃSICO â†’ sugerir e confirmar" },
      { from: "user", text: "Quero ver promoÃ§Ãµes" },
      { from: "system", text: "ğŸ¯ IntenÃ§Ã£o vaga\nğŸ” Perfil: BÃSICO (2 visitas, Ãºltima busca: acessÃ³rios femininos)" },
      { from: "elara", text: "Da Ãºltima vez vocÃª viu acessÃ³rios femininos. Quer ver opÃ§Ãµes parecidas?\n\n[ Sim! ] [ Outra categoria ]" },
      { from: "user", text: "[ Sim! ]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 3: Perfil RICO â†’ ir direto" },
      { from: "user", text: "Tem promoÃ§Ã£o?" },
      { from: "system", text: "ğŸ¯ Perfil RICO (5 visitas): marcas favoritas Nike, Adidas\nâ†’ Pular contextualizaÃ§Ã£o, ir direto" },
      { from: "elara", text: "Separei promoÃ§Ãµes que combinam com o seu gosto â­\n[Carrossel: Nike, Adidas, Puma]" },
      { from: "system", text: "â†’ Segue para: Fluxo Busca e Resultados" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ¯ CenÃ¡rio 4: IntenÃ§Ã£o clara (â‰¤ 5 resultados) â†’ direto" },
      { from: "user", text: "PromoÃ§Ãµes da Pandora" },
      { from: "system", text: "ğŸ¯ IntenÃ§Ã£o clara + â‰¤ 5 resultados â†’ ir DIRETO\nâ†’ Segue para: Fluxo Busca e Resultados" },
      { from: "elara", text: "A *Pandora* estÃ¡ com estas promoÃ§Ãµes ğŸ’\n[Carrossel com 2 cards]" },
    ],
  },
  {
    id: "tracking",
    title: "Tracking de Cards",
    section: "Â§9.6",
    icon: "ğŸ“Š",
    description: "Eventos de impressÃ£o e clique para todos os tipos de card",
    nodes: [
      { id: "tr1", type: "system", label: "Card exibido\n(qualquer tipo)", x: 50, y: 0 },
      { id: "tr2", type: "decision", label: "Tipo de\ncard?", x: 50, y: 14 },
      { id: "tr3", type: "tracking", label: "COMERCIAL:\nad_impression\n(automÃ¡tico)", x: 15, y: 28 },
      { id: "tr4", type: "tracking", label: "INFORMACIONAL:\ninfo_impression\n(automÃ¡tico)", x: 50, y: 28 },
      { id: "tr5", type: "tracking", label: "LOJA:\nstore_impression\n(automÃ¡tico)", x: 85, y: 28 },
      { id: "tr6", type: "decision", label: "UsuÃ¡rio clicou\nem botÃ£o\ndo card?", x: 50, y: 44 },
      { id: "tr7", type: "tracking", label: "ad_click\n(ID anÃºncio,\ntipo aÃ§Ã£o)", x: 15, y: 58 },
      { id: "tr8", type: "tracking", label: "info_click\n(ID conteÃºdo,\ntipo aÃ§Ã£o)", x: 50, y: 58 },
      { id: "tr9", type: "tracking", label: "store_click\n(ID loja,\ntipo aÃ§Ã£o)", x: 85, y: 58 },
      { id: "tr10", type: "system", label: "carousel_scroll\n(swipe entre cards)", x: 50, y: 72 },
      { id: "tr11", type: "system", label: "Regras:\nâ€¢ Todo card â†’ *_impression\nâ€¢ Todo clique â†’ *_click\nâ€¢ Comercial alimenta fadiga\n  â†’ Fluxo: RotaÃ§Ã£o e Fadiga\nâ€¢ session_id em todos", x: 50, y: 88 },
    ],
    edges: [
      { from: "tr1", to: "tr2" },
      { from: "tr2", to: "tr3", label: "Comercial" },
      { from: "tr2", to: "tr4", label: "Informacional" },
      { from: "tr2", to: "tr5", label: "Loja" },
      { from: "tr3", to: "tr6" },
      { from: "tr4", to: "tr6" },
      { from: "tr5", to: "tr6" },
      { from: "tr6", to: "tr7", label: "Comercial" },
      { from: "tr6", to: "tr8", label: "Informacional" },
      { from: "tr6", to: "tr9", label: "Loja" },
    ],
    conversation: [
      { from: "system", text: "ğŸ“Š Card comercial exibido:\nâ†’ ad_impression(id=12, user=456, ctx=orgÃ¢nica)" },
      { from: "elara", text: "[Card: TÃªnis Air Max 50% OFF]\n[ Quero visitar ] [ Como chegar ]" },
      { from: "user", text: "[ Quero visitar ]" },
      { from: "system", text: "ğŸ“Š ad_click(id=12, action=visitar, session=abc123)" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“Š Card informacional exibido:\nâ†’ info_impression(id=5, type=evento)" },
      { from: "elara", text: "[Card: Festival GastronÃ´mico]\n[ Saber mais ] [ Como chegar ]" },
      { from: "user", text: "[ Saber mais ]" },
      { from: "system", text: "ğŸ“Š info_click(id=5, action=saber_mais)" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ“Š Card de loja exibido:\nâ†’ store_impression(id=23, store=Nike)" },
      { from: "elara", text: "[Card: Nike - Bloco 04, Loja 130]\n[ Como chegar ] [ Ver promoÃ§Ãµes ]" },
      { from: "user", text: "[ Como chegar ]" },
      { from: "system", text: "ğŸ“Š store_click(id=23, action=como_chegar)" },
    ],
  },
  {
    id: "profile",
    title: "Perfil como Atalho",
    section: "Â§16.4",
    icon: "ğŸ‘¤",
    description: "Como o perfil persistente dispensa perguntas de contextualizaÃ§Ã£o",
    nodes: [
      { id: "pf1", type: "system", label: "Antes de qualquer\npergunta de\ncontextualizaÃ§Ã£o\n(vem do Fluxo:\nContextualizaÃ§Ã£o)", x: 50, y: 0 },
      { id: "pf2", type: "decision", label: "NÃ­vel de\nriqueza\ndo perfil?", x: 50, y: 14 },
      { id: "pf3", type: "elara", label: "NOVO\n(1a visita):\nContextualizar\nsempre que vago\nâ†’ Fluxo: ContextualizaÃ§Ã£o", x: 15, y: 32 },
      { id: "pf4", type: "elara", label: "BÃSICO\n(1-2 visitas):\nSugerir com\nhistÃ³rico +\nconfirmar", x: 50, y: 32 },
      { id: "pf5", type: "success", label: "RICO\n(3+ visitas):\nIr DIRETO ao resultado\nâ†’ Fluxo: Busca\ne Resultados", x: 85, y: 32 },
      { id: "pf6", type: "info", label: "Dados que dispensam\nperguntas:\nâ€¢ Marcas favoritas (3+)\nâ€¢ Segmento preferido\nâ€¢ HistÃ³rico < 7 dias\nâ€¢ GÃªnero inferido", x: 50, y: 54 },
      { id: "pf7", type: "danger", label: "Limites:\nâ€¢ Dados > 30 dias:\n  nÃ£o usar\nâ€¢ Contexto atual\n  prevalece sobre perfil\nâ€¢ Sempre oferecer\n  [ Buscar outra coisa ]", x: 50, y: 76 },
    ],
    edges: [
      { from: "pf1", to: "pf2" },
      { from: "pf2", to: "pf3", label: "Novo" },
      { from: "pf2", to: "pf4", label: "BÃ¡sico" },
      { from: "pf2", to: "pf5", label: "Rico" },
      { from: "pf3", to: "pf6" },
      { from: "pf4", to: "pf6" },
      { from: "pf5", to: "pf6" },
    ],
    conversation: [
      { from: "system", text: "ğŸ‘¤ Perfil RICO: 5 visitas\nâ€¢ Marcas favoritas: Nike, Adidas\nâ€¢ Segmento: Esportivo\nâ€¢ Ãšltima visita: 3 dias atrÃ¡s" },
      { from: "user", text: "Quero ver promoÃ§Ãµes" },
      { from: "system", text: "ğŸ‘¤ Perfil rico â†’ pular contextualizaÃ§Ã£o\nâ†’ Ir direto: Fluxo Busca e Resultados" },
      { from: "elara", text: "Separei promoÃ§Ãµes que combinam com o seu gosto â­\n[Carrossel: Nike, Adidas, Puma]\n\n[ Quero visitar ] [ Buscar outra coisa ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ‘¤ Perfil BÃSICO: 2 visitas\nâ€¢ Ãšltima busca: acessÃ³rios femininos" },
      { from: "user", text: "Quero um presente" },
      { from: "elara", text: "Da Ãºltima vez vocÃª viu acessÃ³rios femininos. Quer ver opÃ§Ãµes parecidas?\n\n[ Sim! ] [ Outra categoria ]" },
      { from: "system", text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" },
      { from: "system", text: "ğŸ‘¤ Perfil NOVO: primeira visita\nâ†’ NÃ£o tem dados para personalizar" },
      { from: "user", text: "Quero ver ofertas" },
      { from: "system", text: "ğŸ‘¤ Perfil novo â†’ contextualizar\nâ†’ Segue para: Fluxo ContextualizaÃ§Ã£o" },
      { from: "elara", text: "Que tipo de ofertas te interessa?\n\n[ Moda ] [ Esportivo ] [ AlimentaÃ§Ã£o ] [ AcessÃ³rios ]" },
    ],
  },
];

// â”€â”€â”€ Node â†’ Scenario mapping (nodeId â†’ scenario index) â”€â”€â”€
// Each flow's conversation is split by divider lines into discrete scenarios.
// Clicking a node shows ONLY the scenario for that specific path.
const NODE_CHAT_MAP = {
  terms: { t1:0, t2:0, t3:3, t4:0, t5:0, t6:0, t7:1, t8:1, t9:1, t10:2, t11:0 },
  entry: { e1:0, e2:0, e3:0, e4:1, e5:0, e6:0, e7:2, e8:0 },
  hierarchy: { h1:0, h2:0, h3:2, h4:0, h5:3, h6:0, h7:0, h8:1, h9:1, h10:1, h11:0 },
  search: { s1:0, s2:0, s3:0, s4:0, s5:3, s6:2, s7:1, s8:0, s9:0, s10:0, s11:0, s12:0, s13:0, s14:0 },
  fallback: { f1:0, f2:0, f3:0, f4:7, f5:0, f6:0, f7:1, f16:1, f17:1, f18:2, f19:2, f20:3, f8:4, f9:4, f10:8, f21:5, f22:9, f23:5, f11:6, f12:10, f13:6, f14:5, f15:5 },
  pagination: { p1:0, p2:0, p3:0, p4:0, p5:1, p6:0, p7:0, p8:0 },
  proactive: { pr1:0, pr2:0, pr3:0, pr4:3, pr5:3, pr6:2, pr7:0, pr8:0, pr9:1, pr10:2 },
  bridge: { b1:0, b2:0, b3:0, b4:1, b5:0, b6:2, b7:0, b8:3, b9:4, b10:0 },
  fatigue: { fa1:0, fa2:0, fa3:1, fa4:0, fa5:0, fa6:0, fa7:0, fa8:2, fa9:0 },
  stores: { st1:0, st2:0, st3:1, st4:1, st5:2, st6:2, st7:3, st8:0, st9:0, st10:0, st11:0 },
  reengagement: { r1:0, r2:0, r3:0, r4:1, r5:0, r6:0, r7:0, r8:0, r9:1, r10:2, r11:3, r12:3 },
  restrictions: { x1:0, x2:0, x3:0, x4:1, x5:2, x6:3, x7:4, x8:0, x9:0, x10:0 },
  nps: { n1:0, n2:0, n3:2, n4:0, n5:0, n6:0, n7:1, n8:1, n9:2 },
  context: { c1:0, c2:0, c3:0, c4:0, c5:1, c6:2, c7:2, c8:0 },
  contextualization: { ctx1:0, ctx2:0, ctx3:3, ctx4:0, ctx5:2, ctx6:1, ctx7:0, ctx8:0 },
  tracking: { tr1:0, tr2:0, tr3:0, tr4:1, tr5:2, tr6:0, tr7:0, tr8:1, tr9:2, tr10:0, tr11:0 },
  profile: { pf1:0, pf2:0, pf3:2, pf4:1, pf5:0, pf6:0, pf7:0 },
};

// â”€â”€â”€ Layout multipliers â”€â”€â”€
const MX = 14;   // x multiplier (node.x * MX = SVG x)
const MY = 9.5;  // y multiplier (node.y * MY = SVG y)

// â”€â”€â”€ Helper: compute node dimensions from label â”€â”€â”€
const getNodeSize = (label, scale = 1) => {
  const lines = label.split("\n");
  const lineCount = lines.length;
  const longestLine = Math.max(...lines.map(l => l.length));
  const charW = 5.0;
  const lineH = 12;
  const padX = 24;
  const padY = 18;
  const w = Math.max(124, longestLine * charW + padX) * scale;
  const h = Math.max(56, lineCount * lineH + padY) * scale;
  return { w, h };
};

// â”€â”€â”€ Helper Components â”€â”€â”€
const NodeBox = ({ node, isSelected, onClick, scale = 1 }) => {
  const colorMap = {
    user: { bg: "#25D366", text: "#FFF", border: "#128C7E" },
    elara: { bg: "#DCF8C6", text: "#111", border: "#25D366" },
    decision: { bg: "#FEF3C7", text: "#92400E", border: "#F59E0B" },
    system: { bg: "#EEF2FF", text: "#3730A3", border: "#6366F1" },
    danger: { bg: "#FEE2E2", text: "#991B1B", border: "#EF4444" },
    success: { bg: "#D1FAE5", text: "#065F46", border: "#10B981" },
    info: { bg: "#DBEAFE", text: "#1E40AF", border: "#3B82F6" },
    tracking: { bg: "#EDE9FE", text: "#5B21B6", border: "#8B5CF6" },
  };
  const c = colorMap[node.type] || colorMap.system;
  const isDecision = node.type === "decision";
  const { w, h } = getNodeSize(node.label, scale);
  const lines = node.label.split("\n");

  return (
    <g
      onClick={() => onClick?.(node)}
      style={{ cursor: "pointer" }}
      transform={`translate(${node.x * MX}, ${node.y * MY})`}
    >
      {isSelected && (
        <rect
          x={-w / 2 - 3}
          y={-h / 2 - 3}
          width={w + 6}
          height={h + 6}
          rx={isDecision ? 5 : 10}
          fill="none"
          stroke="#075E54"
          strokeWidth={2}
          strokeDasharray="4 2"
          opacity={0.6}
        />
      )}
      <rect
        x={-w / 2}
        y={-h / 2}
        width={w}
        height={h}
        rx={isDecision ? 3 : 8}
        fill={c.bg}
        stroke={isSelected ? "#075E54" : c.border}
        strokeWidth={isSelected ? 2.5 : 1.5}
      />
      {lines.map((line, i, arr) => (
        <text
          key={i}
          x={0}
          y={(-6 * (arr.length - 1) + i * 12) * scale}
          textAnchor="middle"
          dominantBaseline="central"
          fill={c.text}
          fontSize={8.5 * scale}
          fontFamily="system-ui, sans-serif"
          fontWeight={i === 0 ? 600 : 400}
        >
          {line}
        </text>
      ))}
    </g>
  );
};

const Edge = ({ from, to, label, nodes }) => {
  const n1 = nodes.find((n) => n.id === from);
  const n2 = nodes.find((n) => n.id === to);
  if (!n1 || !n2) return null;

  const h1 = getNodeSize(n1.label).h;
  const h2 = getNodeSize(n2.label).h;
  const x1 = n1.x * MX;
  const y1 = n1.y * MY + h1 / 2;
  const x2 = n2.x * MX;
  const y2 = n2.y * MY - h2 / 2;
  const mx = (x1 + x2) / 2;
  const my = (y1 + y2) / 2;

  return (
    <g>
      <path
        d={`M ${x1} ${y1} C ${x1} ${my}, ${x2} ${my}, ${x2} ${y2}`}
        fill="none"
        stroke="#9CA3AF"
        strokeWidth={1.2}
        markerEnd="url(#arrow)"
      />
      {label && (() => {
        const edgeLines = label.split("\n");
        const longestEdgeLine = Math.max(...edgeLines.map(l => l.length));
        const ew = longestEdgeLine * 4.5 + 12;
        const eh = edgeLines.length * 10 + 6;
        return (
          <g>
            <rect
              x={mx - ew / 2}
              y={my - eh / 2 - 2}
              width={ew}
              height={eh}
              rx={4}
              fill="#FFF"
              stroke="#D1D5DB"
              strokeWidth={0.8}
              opacity={0.95}
            />
            <text
              x={mx}
              y={my - (edgeLines.length - 1) * 5}
              textAnchor="middle"
              dominantBaseline="central"
              fill="#6B7280"
              fontSize={7}
              fontFamily="system-ui"
              fontWeight={600}
            >
              {edgeLines.map((l, i) => (
                <tspan key={i} x={mx} dy={i === 0 ? 0 : 10}>
                  {l}
                </tspan>
              ))}
            </text>
          </g>
        );
      })()}
    </g>
  );
};

const ChatBubble = ({ msg }) => {
  const isUser = msg.from === "user";
  const isSystem = msg.from === "system";

  if (isSystem) {
    return (
      <div
        style={{
          textAlign: "center",
          padding: "4px 12px",
          margin: "6px 24px",
          fontSize: "11px",
          color: "#6366F1",
          background: "#EEF2FF",
          borderRadius: "12px",
          fontFamily: "monospace",
          whiteSpace: "pre-wrap",
        }}
      >
        {msg.text}
      </div>
    );
  }

  return (
    <div
      style={{
        display: "flex",
        justifyContent: isUser ? "flex-end" : "flex-start",
        padding: "3px 12px",
      }}
    >
      <div
        style={{
          maxWidth: "85%",
          padding: "8px 12px",
          borderRadius: isUser ? "12px 12px 0 12px" : "12px 12px 12px 0",
          background: isUser ? "#DCF8C6" : "#FFFFFF",
          fontSize: "12px",
          lineHeight: "1.4",
          whiteSpace: "pre-wrap",
          boxShadow: "0 1px 2px rgba(0,0,0,0.08)",
          fontFamily: "system-ui",
        }}
      >
        <div
          style={{
            fontSize: "9px",
            fontWeight: 700,
            color: isUser ? "#128C7E" : "#075E54",
            marginBottom: "2px",
          }}
        >
          {isUser ? "UsuÃ¡rio" : "Elara"}
        </div>
        {msg.text}
      </div>
    </div>
  );
};

// â”€â”€â”€ Main Component â”€â”€â”€
function ElaraFlowchart() {
  const [selectedFlow, setSelectedFlow] = useState("entry");
  const [showChat, setShowChat] = useState(true);
  const [zoom, setZoom] = useState(1);
  const [selectedNodeId, setSelectedNodeId] = useState(null);

  const flow = useMemo(
    () => FLOWS.find((f) => f.id === selectedFlow),
    [selectedFlow]
  );

  // Split conversation into discrete scenarios by divider lines
  const scenarios = useMemo(() => {
    if (!flow) return [];
    const result = [];
    let current = [];
    for (const msg of flow.conversation) {
      if (msg.from === "system" && /^[\u2500]+$/.test(msg.text)) {
        if (current.length > 0) result.push(current);
        current = [];
      } else {
        current.push(msg);
      }
    }
    if (current.length > 0) result.push(current);
    return result;
  }, [flow]);

  const visibleConversation = useMemo(() => {
    if (!flow) return [];
    if (!selectedNodeId) return flow.conversation;
    const map = NODE_CHAT_MAP[flow.id];
    if (!map || !(selectedNodeId in map)) return flow.conversation;
    const scenarioIdx = map[selectedNodeId];
    if (scenarioIdx >= 0 && scenarioIdx < scenarios.length) {
      return scenarios[scenarioIdx];
    }
    return flow.conversation;
  }, [flow, selectedNodeId, scenarios]);

  const handleFlowSelect = useCallback((id) => {
    setSelectedFlow(id);
    setSelectedNodeId(null);
    setZoom(1);
  }, []);

  return (
    <div
      style={{
        display: "flex",
        height: "100vh",
        width: "100vw",
        overflow: "hidden",
        fontFamily: "system-ui, -apple-system, sans-serif",
        background: "#F9FAFB",
        color: COLORS.textPrimary,
      }}
    >
      {/* â”€â”€â”€ Sidebar â”€â”€â”€ */}
      <div
        style={{
          width: "240px",
          minWidth: "240px",
          background: "#075E54",
          color: "#FFF",
          overflowY: "auto",
          display: "flex",
          flexDirection: "column",
        }}
      >
        <div
          style={{
            padding: "16px",
            borderBottom: "1px solid rgba(255,255,255,0.15)",
          }}
        >
          <div style={{ fontSize: "18px", fontWeight: 700 }}>
            Fluxograma Elara
          </div>
          <div style={{ fontSize: "11px", opacity: 0.7, marginTop: "4px" }}>
            Outlet Premium SP
          </div>
          <div
            style={{
              fontSize: "10px",
              opacity: 0.5,
              marginTop: "2px",
            }}
          >
            {FLOWS.length} fluxos mapeados
          </div>
        </div>

        <div style={{ flex: 1, padding: "8px" }}>
          {FLOWS.map((f) => (
            <button
              key={f.id}
              onClick={() => handleFlowSelect(f.id)}
              style={{
                display: "flex",
                alignItems: "center",
                gap: "8px",
                width: "100%",
                padding: "10px 12px",
                marginBottom: "2px",
                border: "none",
                borderRadius: "8px",
                background:
                  selectedFlow === f.id
                    ? "rgba(255,255,255,0.2)"
                    : "transparent",
                color: "#FFF",
                fontSize: "12px",
                fontWeight: selectedFlow === f.id ? 700 : 400,
                cursor: "pointer",
                textAlign: "left",
                transition: "background 0.15s",
              }}
            >
              <span style={{ fontSize: "16px" }}>{f.icon}</span>
              <div>
                <div>{f.title}</div>
                <div style={{ fontSize: "9px", opacity: 0.6 }}>
                  {f.section}
                </div>
              </div>
            </button>
          ))}
        </div>

        <div
          style={{
            padding: "12px",
            borderTop: "1px solid rgba(255,255,255,0.15)",
          }}
        >
          <div style={{ fontSize: "9px", opacity: 0.5 }}>
            Legenda dos nÃ³s:
          </div>
          {[
            { color: "#25D366", label: "UsuÃ¡rio" },
            { color: "#DCF8C6", label: "Elara (resposta)", textColor: "#111" },
            { color: "#FEF3C7", label: "DecisÃ£o", textColor: "#92400E" },
            { color: "#EEF2FF", label: "Sistema", textColor: "#3730A3" },
            { color: "#FEE2E2", label: "Alerta/Proibido", textColor: "#991B1B" },
            { color: "#D1FAE5", label: "Sucesso", textColor: "#065F46" },
          ].map((item) => (
            <div
              key={item.label}
              style={{
                display: "flex",
                alignItems: "center",
                gap: "6px",
                marginTop: "4px",
              }}
            >
              <div
                style={{
                  width: "12px",
                  height: "12px",
                  borderRadius: "3px",
                  background: item.color,
                  border: "1px solid rgba(0,0,0,0.15)",
                }}
              />
              <span style={{ fontSize: "9px", opacity: 0.7 }}>
                {item.label}
              </span>
            </div>
          ))}
        </div>
      </div>

      {/* â”€â”€â”€ Main Content â”€â”€â”€ */}
      <div style={{ flex: 1, display: "flex", flexDirection: "column", minWidth: 0, overflow: "hidden" }}>
        {/* Header */}
        <div
          style={{
            display: "flex",
            alignItems: "center",
            justifyContent: "space-between",
            padding: "12px 20px",
            background: "#FFF",
            borderBottom: `1px solid ${COLORS.border}`,
            flexShrink: 0,
          }}
        >
          <div>
            <div style={{ display: "flex", alignItems: "center", gap: "8px" }}>
              <span style={{ fontSize: "24px" }}>{flow?.icon}</span>
              <div>
                <h2 style={{ fontSize: "16px", fontWeight: 700, margin: 0 }}>
                  {flow?.title}
                </h2>
                <span
                  style={{
                    fontSize: "11px",
                    color: COLORS.textSecondary,
                  }}
                >
                  {flow?.section} - {flow?.description}
                </span>
              </div>
            </div>
          </div>
          <div style={{ display: "flex", gap: "8px", alignItems: "center" }}>
            <div style={{ display: "flex", gap: "4px" }}>
              <button
                onClick={() => setZoom((z) => Math.max(0.5, z - 0.15))}
                style={{
                  padding: "4px 10px",
                  border: `1px solid ${COLORS.border}`,
                  borderRadius: "6px",
                  background: "#FFF",
                  cursor: "pointer",
                  fontSize: "14px",
                }}
              >
                -
              </button>
              <span
                style={{
                  padding: "4px 8px",
                  fontSize: "11px",
                  color: COLORS.textSecondary,
                }}
              >
                {Math.round(zoom * 100)}%
              </span>
              <button
                onClick={() => setZoom((z) => Math.min(2, z + 0.15))}
                style={{
                  padding: "4px 10px",
                  border: `1px solid ${COLORS.border}`,
                  borderRadius: "6px",
                  background: "#FFF",
                  cursor: "pointer",
                  fontSize: "14px",
                }}
              >
                +
              </button>
            </div>
            <button
              onClick={() => setShowChat(!showChat)}
              style={{
                padding: "6px 14px",
                border: `1px solid ${COLORS.border}`,
                borderRadius: "8px",
                background: showChat ? "#075E54" : "#FFF",
                color: showChat ? "#FFF" : COLORS.textPrimary,
                cursor: "pointer",
                fontSize: "11px",
                fontWeight: 600,
              }}
            >
              {showChat ? "Ocultar Chat" : "Ver Chat"}
            </button>
          </div>
        </div>

        {/* Content Area */}
        <div style={{ flex: 1, display: "flex", overflow: "hidden", minHeight: 0 }}>
          {/* Flowchart */}
          <div
            style={{
              flex: 1,
              overflow: "auto",
              background: "#F3F4F6",
              position: "relative",
              minWidth: 0,
            }}
          >
            <svg
              width={1600 * zoom}
              height={1300 * zoom}
              viewBox="-100 -60 1600 1300"
              style={{ display: "block" }}
            >
              <defs>
                <marker
                  id="arrow"
                  viewBox="0 0 10 10"
                  refX="9"
                  refY="5"
                  markerWidth="6"
                  markerHeight="6"
                  orient="auto-start-reverse"
                >
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="#9CA3AF" />
                </marker>
              </defs>

              {/* Edges */}
              {flow?.edges.map((edge, i) => (
                <Edge
                  key={i}
                  from={edge.from}
                  to={edge.to}
                  label={edge.label}
                  nodes={flow.nodes}
                />
              ))}

              {/* Nodes */}
              {flow?.nodes.map((node) => (
                <NodeBox key={node.id} node={node} scale={1} isSelected={selectedNodeId === node.id} onClick={(n) => setSelectedNodeId(selectedNodeId === n.id ? null : n.id)} />
              ))}
            </svg>
          </div>

          {/* Chat Simulation */}
          {showChat && (
            <div
              style={{
                width: "320px",
                minWidth: "320px",
                maxWidth: "320px",
                flexShrink: 0,
                borderLeft: `1px solid ${COLORS.border}`,
                display: "flex",
                flexDirection: "column",
                background: "#FFF",
              }}
            >
              <div
                style={{
                  padding: "12px 16px",
                  background: "#075E54",
                  color: "#FFF",
                  display: "flex",
                  alignItems: "center",
                  gap: "10px",
                }}
              >
                <div
                  style={{
                    width: "32px",
                    height: "32px",
                    borderRadius: "50%",
                    background: "#25D366",
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "center",
                    fontSize: "16px",
                  }}
                >
                  E
                </div>
                <div>
                  <div style={{ fontSize: "13px", fontWeight: 600 }}>
                    Elara
                  </div>
                  <div style={{ fontSize: "10px", opacity: 0.7 }}>
                    SimulaÃ§Ã£o de conversa
                  </div>
                </div>
              </div>

              <div
                style={{
                  flex: 1,
                  overflowY: "auto",
                  background: COLORS.bg,
                  padding: "8px 0",
                }}
              >
                <div
                  style={{
                    textAlign: "center",
                    padding: "4px 12px",
                    margin: "4px 40px 8px",
                    fontSize: "10px",
                    color: "#6B7280",
                    background: "rgba(255,255,255,0.8)",
                    borderRadius: "8px",
                  }}
                >
                  {flow?.icon} {flow?.title}
                </div>
                {selectedNodeId && (
                  <div
                    style={{
                      textAlign: "center",
                      padding: "6px 12px",
                      margin: "4px 16px 4px",
                      fontSize: "10px",
                      color: "#FFF",
                      background: "#075E54",
                      borderRadius: "8px",
                      cursor: "pointer",
                      fontWeight: 600,
                    }}
                    onClick={() => setSelectedNodeId(null)}
                  >
                    Cenario: {flow?.nodes.find(n => n.id === selectedNodeId)?.label.split("\n")[0]} - Clique para ver todos
                  </div>
                )}
                {visibleConversation.map((msg, i) => (
                  <ChatBubble key={i} msg={msg} />
                ))}
              </div>

              <div
                style={{
                  padding: "8px 12px",
                  borderTop: `1px solid ${COLORS.border}`,
                  background: "#F0F0F0",
                  fontSize: "10px",
                  color: "#999",
                  textAlign: "center",
                }}
              >
                {selectedNodeId
                  ? "Clique em outro no para ver seu cenario, ou no banner para ver todos"
                  : "Clique em um no do fluxograma para ver o cenario daquele caminho"}
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<ElaraFlowchart />);
</script>
</body>
</html>